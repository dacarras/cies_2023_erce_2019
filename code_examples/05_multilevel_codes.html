<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM+8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB/aFGpk3jaTY6xa8JAGMW/O62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v+k/0an2i+itHDw3v2+9+DBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3/I7AtxEJLtzzuZfI+VVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy/Lt7Kc+0vWY/gAgIIEqAN9we0pwKXreiMasxvabDQMM4riO+qxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw+ymhce7vwM9jSqO8JyVd5RH9gyTt2+J/yUmYlIR0s04n6+7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv/ocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi+W2+MjCzMIDApSwvXzC97Z4Ig8N/BxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh/8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT+AEjAwuDFpBmA9KMDEwMCh9i/v8H8sH0/4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9/lqYwOGZxeUelN2U2R6+cArgtCJpauW7UQBqnFkUsjAY/kOU1cP+DAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl+vvmM/byA48e6tWrKArm4ZJlCbdsrxksL1AwWn/yBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO//sdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd/89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF+9JOS0nbaaYDCQfwCJ7Au3AHj+LO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm+EBXuAbHmIMSRMs+4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL+hD7C1xoaHeLJSEao0FEW14ckxC+TU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13/+lm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl+9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O/AdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB///AA8AAQAAAAAAAAAAAAAAAAABAAAAAA==) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
box-sizing: border-box;
min-width: 200px;
max-width: 980px;
margin: 0 auto;
padding: 45px;
padding-top: 0px;
}
</style>


</head>

<body>

<h1 id="cies-intro-to-erce-with-r">CIES: Intro to ERCE with R</h1>
<p>Carrasco, D. February 18th, 2023</p>
<style>
.main-container {
max-width: 1600px !important;
}
.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
background-color: #373334;
}
</style>

<h1 id="libraries-we-need-to-install">Libraries we need to install</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># libraries</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># library to install libraries from github</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;devtools&#39;</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># library with ERCE data</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># library is in development</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&#39;dacarras/erce&#39;</span>,<span class="at">force =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># libraries we have been usoibg</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;tidyverse&#39;</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;mitools&#39;</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;survey&#39;</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;srvyr&#39;</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># libraries to fit models</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;MplusAutomation&#39;</span>) <span class="co"># requires Mplus</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;RStata&#39;</span>)          <span class="co"># requires Stata</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;WeMix&#39;</span>)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co"># to extract estimates</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;texreg&#39;</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;miceadds&#39;</span>)</span></code></pre></div>
<h1 id="code-11-prepare-data-for-multilevel-modelling">Code 1.1: prepare
data for multilevel modelling</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># prepara data for multilevel models</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># load main library</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># add common clustering variables</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>data_a6 <span class="ot">&lt;-</span> erce<span class="sc">::</span>erce_2019_qa6 <span class="sc">%&gt;%</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>erce<span class="sc">::</span><span class="fu">remove_labels</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">id_k =</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(<span class="fu">paste0</span>(IDCNTRY)))) <span class="sc">%&gt;%</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">id_s =</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(<span class="fu">paste0</span>(IDCNTRY, <span class="st">&quot;_&quot;</span>, STRATA)))) <span class="sc">%&gt;%</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">id_j =</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(<span class="fu">paste0</span>(IDCNTRY, <span class="st">&quot;_&quot;</span>, IDSCHOOL)))) <span class="sc">%&gt;%</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">id_i =</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(.)))</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co"># add country names</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>country_names <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="at">text=</span><span class="st">&quot;</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="st">IDCNTRY ctry_name</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="st">  32    &#39;Argentina&#39;              </span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="st">  76    &#39;Brasil&#39;</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="st"> 170    &#39;Colombia&#39;</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="st"> 188    &#39;Costa Rica&#39;</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="st"> 192    &#39;Cuba&#39;</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="st"> 214    &#39;Rep√∫blica Dominicana&#39;</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="st"> 218    &#39;Ecuador&#39;   </span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="st"> 222    &#39;El Salvador&#39;</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="st"> 320    &#39;Guatemala&#39;</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="st"> 340    &#39;Honduras&#39;</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="st"> 484    &#39;M√©xico&#39;</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="st"> 558    &#39;Nicaragua&#39;</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="st"> 591    &#39;Panam√°&#39;</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="st"> 600    &#39;Paraguay&#39;</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="st"> 604    &#39;Per√∫&#39;</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="st"> 858    &#39;Uruguay&#39;</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span>,</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">IDCNTRY =</span> <span class="fu">as.numeric</span>(IDCNTRY))</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>data_a6 <span class="ot">&lt;-</span> data_a6 <span class="sc">%&gt;%</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">left_join</span>(., country_names, <span class="at">by =</span> <span class="st">&#39;IDCNTRY&#39;</span>)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="co"># add senate weight (scaled up to 1000)</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>data_a6 <span class="ot">&lt;-</span> data_a6 <span class="sc">%&gt;%</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>           <span class="co"># rename the original name</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rename</span>(<span class="at">WS_previous =</span> WS) <span class="sc">%&gt;%</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>           <span class="co"># we add the new WS variable</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>           erce<span class="sc">::</span><span class="fu">senate_weights</span>(.,</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="dv">1000</span>,</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>           <span class="at">wt =</span> <span class="st">&#39;WT&#39;</span>,</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>           <span class="at">id_k =</span> <span class="st">&#39;id_k&#39;</span>)</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: we are erasing the original variable.</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a><span class="co">#       This is a redundant operation.</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a><span class="co">#       We are including this step just to illustrate</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a><span class="co">#       how to use this function.</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a><span class="co"># add multilevel survey weights</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>data_a6 <span class="ot">&lt;-</span> data_a6 <span class="sc">%&gt;%</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>           erce<span class="sc">::</span><span class="fu">lsa_weights</span>(.,</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>           <span class="at">id_i =</span> <span class="st">&#39;id_i&#39;</span>,</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>           <span class="at">id_j =</span> <span class="st">&#39;id_j&#39;</span>,</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>           <span class="at">id_k =</span> <span class="st">&#39;id_k&#39;</span>,</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>           <span class="at">wt =</span> <span class="st">&#39;WT&#39;</span>,</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>           <span class="at">wi =</span> <span class="st">&#39;WI&#39;</span>,</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>           <span class="at">wj =</span> <span class="st">&#39;WJ&#39;</span> )</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a><span class="co"># show the sum of weights</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>data_a6 <span class="sc">%&gt;%</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(id_k, ctry_name) <span class="sc">%&gt;%</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(</span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">sum_of_raw_weights =</span> <span class="fu">sum</span>(WT),</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">sum_of_senate_weights =</span> <span class="fu">sum</span>(ws),</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>  <span class="at">sum_of_normalized_weights =</span> <span class="fu">sum</span>(wa1<span class="sc">*</span>wa2),</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>  <span class="at">sum_of_effective_sample_weights =</span> <span class="fu">sum</span>(wb1<span class="sc">*</span>wb2),</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>  <span class="at">number_of_observations =</span> <span class="fu">n</span>()</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<pre><code>## [1m[22m`summarise()` has grouped output by &#39;id_k&#39;. You can override using the
## `.groups` argument.</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">id_k</th>
<th align="left">ctry_name</th>
<th align="right">sum_of_raw_weights</th>
<th align="right">sum_of_senate_weights</th>
<th align="right">sum_of_normalized_weights</th>
<th align="right">sum_of_effective_sample_weights</th>
<th align="right">number_of_observations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">Colombia</td>
<td align="right">847931</td>
<td align="right">1000</td>
<td align="right">4467</td>
<td align="right">4467</td>
<td align="right">4467</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">Costa Rica</td>
<td align="right">67429</td>
<td align="right">1000</td>
<td align="right">3699</td>
<td align="right">3699</td>
<td align="right">3699</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">Cuba</td>
<td align="right">100032</td>
<td align="right">1000</td>
<td align="right">5126</td>
<td align="right">5126</td>
<td align="right">5126</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">Rep√∫blica Dominicana</td>
<td align="right">158845</td>
<td align="right">1000</td>
<td align="right">4899</td>
<td align="right">4899</td>
<td align="right">4899</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">Ecuador</td>
<td align="right">292011</td>
<td align="right">1000</td>
<td align="right">6758</td>
<td align="right">6758</td>
<td align="right">6758</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">El Salvador</td>
<td align="right">99394</td>
<td align="right">1000</td>
<td align="right">5920</td>
<td align="right">5920</td>
<td align="right">5920</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="left">Argentina</td>
<td align="right">820043</td>
<td align="right">1000</td>
<td align="right">5004</td>
<td align="right">5004</td>
<td align="right">5004</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="left">Guatemala</td>
<td align="right">307831</td>
<td align="right">1000</td>
<td align="right">4895</td>
<td align="right">4895</td>
<td align="right">4895</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="left">Honduras</td>
<td align="right">184823</td>
<td align="right">1000</td>
<td align="right">4423</td>
<td align="right">4423</td>
<td align="right">4423</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="left">M√©xico</td>
<td align="right">2291802</td>
<td align="right">1000</td>
<td align="right">4824</td>
<td align="right">4824</td>
<td align="right">4824</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="left">Nicaragua</td>
<td align="right">58864</td>
<td align="right">1000</td>
<td align="right">4868</td>
<td align="right">4868</td>
<td align="right">4868</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="left">Panam√°</td>
<td align="right">66555</td>
<td align="right">1000</td>
<td align="right">5632</td>
<td align="right">5632</td>
<td align="right">5632</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="left">Paraguay</td>
<td align="right">105751</td>
<td align="right">1000</td>
<td align="right">4849</td>
<td align="right">4849</td>
<td align="right">4849</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="left">Per√∫</td>
<td align="right">534576</td>
<td align="right">1000</td>
<td align="right">5938</td>
<td align="right">5938</td>
<td align="right">5938</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="left">Brasil</td>
<td align="right">3123877</td>
<td align="right">1000</td>
<td align="right">4349</td>
<td align="right">4349</td>
<td align="right">4349</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="left">Uruguay</td>
<td align="right">49882</td>
<td align="right">1000</td>
<td align="right">5176</td>
<td align="right">5176</td>
<td align="right">5176</td>
</tr>
</tbody>
</table>
<h1 id="code-12-prepare-covariates">Code 1.2: Prepare covariates</h1>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># add school covariates</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create variable representing school population density</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>urba_a6 <span class="ot">&lt;-</span> erce<span class="sc">::</span>erce_2019_qd6 <span class="sc">%&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>           <span class="fu">mutate</span>(<span class="at">urba =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>            DDIT19 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">0</span>, <span class="co"># 2.000 people or less</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>            DDIT19 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">0</span>, <span class="co"># Between 2.001 and 5.000 people</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>            DDIT19 <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="dv">0</span>, <span class="co"># Between 5.001 and 10.000 people</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>            DDIT19 <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="co"># Between 10.001 and 100.000 people</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>            DDIT19 <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="dv">1</span>  <span class="co"># More than 100.000 people</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>            )) <span class="sc">%&gt;%</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>            IDCNTRY, IDSCHOOL, urba)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co"># add school covariate</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>data_model <span class="ot">&lt;-</span> data_a6 <span class="sc">%&gt;%</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">left_join</span>(., urba_a6,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;IDCNTRY&#39;</span>, <span class="st">&#39;IDSCHOOL&#39;</span>))</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="co"># centering variables (manually), Z == ses</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>data_model <span class="ot">&lt;-</span> data_model <span class="sc">%&gt;%</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="do">## socio economic status</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">z =</span> ISECF)  <span class="sc">%&gt;%</span>                      <span class="co"># mean score</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">z_c =</span> r4sda<span class="sc">::</span><span class="fu">c_mean</span>(z, id_j)) <span class="sc">%&gt;%</span>    <span class="co"># means by group</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">z_g =</span> r4sda<span class="sc">::</span><span class="fu">c_mean</span>(z, id_k)) <span class="sc">%&gt;%</span>    <span class="co"># grand mean    </span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">z_w =</span> z <span class="sc">-</span> z_c   )    <span class="sc">%&gt;%</span>  <span class="co"># centering within cluster</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">z_m =</span> z <span class="sc">-</span> z_g   )    <span class="sc">%&gt;%</span>  <span class="co"># centering to the grand mean</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">z_b =</span> z_c <span class="sc">-</span> z_g )         <span class="co"># centered cluster means</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="co"># centering variables (manually), V == urba</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>data_model <span class="ot">&lt;-</span> data_model <span class="sc">%&gt;%</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a><span class="do">## student responses</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">v =</span> urba)  <span class="sc">%&gt;%</span>                       <span class="co"># mean score</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">v_c =</span> r4sda<span class="sc">::</span><span class="fu">c_mean</span>(v, id_j)) <span class="sc">%&gt;%</span>    <span class="co"># means by group</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">v_g =</span> r4sda<span class="sc">::</span><span class="fu">c_mean</span>(v, id_k)) <span class="sc">%&gt;%</span>    <span class="co"># grand mean    </span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">v_w =</span> v <span class="sc">-</span> v_c   )    <span class="sc">%&gt;%</span>  <span class="co"># centering within cluster</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">v_m =</span> v <span class="sc">-</span> v_g   )    <span class="sc">%&gt;%</span>  <span class="co"># centering to the grand mean</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">v_b =</span> v_c <span class="sc">-</span> v_g )         <span class="co"># centered cluster means</span></span></code></pre></div>
<h1 id="code-13-multilevel-model-with-lmertest">Code 1.3 multilevel
model with <code>lmerTest</code></h1>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># multilevel model without sampling design</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># configure R console output</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">10</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>data_model <span class="sc">%&gt;%</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(ctry_name <span class="sc">==</span> <span class="st">&#39;Paraguay&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>lmerTest<span class="sc">::</span><span class="fu">lmer</span>(MAT_1 <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> z_w <span class="sc">+</span> z_b <span class="sc">+</span> v_b <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id_j), <span class="at">data =</span> ., <span class="at">REML =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>broom.mixed<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">effect</th>
<th align="left">group</th>
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">df</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">fixed</td>
<td align="left"></td>
<td align="left">(Intercept)</td>
<td align="right">653.67</td>
<td align="right">3.00</td>
<td align="right">218.01</td>
<td align="right">221.86</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">fixed</td>
<td align="left"></td>
<td align="left">z_w</td>
<td align="right">13.68</td>
<td align="right">1.47</td>
<td align="right">9.32</td>
<td align="right">4226.13</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">fixed</td>
<td align="left"></td>
<td align="left">z_b</td>
<td align="right">45.76</td>
<td align="right">5.35</td>
<td align="right">8.55</td>
<td align="right">246.39</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">fixed</td>
<td align="left"></td>
<td align="left">v_b</td>
<td align="right">10.73</td>
<td align="right">7.62</td>
<td align="right">1.41</td>
<td align="right">215.33</td>
<td align="right">0.16</td>
</tr>
<tr class="odd">
<td align="left">ran_pars</td>
<td align="left">id_j</td>
<td align="left">sd__(Intercept)</td>
<td align="right">42.40</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="left">ran_pars</td>
<td align="left">Residual</td>
<td align="left">sd__Observation</td>
<td align="right">67.40</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
</tr>
</tbody>
</table>
<h1 id="code-14-multilevel-model-with-mplus-using-plausible-values">Code
1.4 multilevel model with <code>Mplus</code>, using plausible
values</h1>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># multilevel model with Mplus</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># prepared data for mplus</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>data_mixed <span class="ot">&lt;-</span> data_model <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">filter</span>(ctry_name <span class="sc">==</span> <span class="st">&#39;Paraguay&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rename_all</span>(tolower) <span class="sc">%&gt;%</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>              mat_1, mat_2, mat_3, mat_4, mat_5,</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>              id_k, id_s, id_j, id_i,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>              wb1, wb2, wi, wj,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>              z_w, z_b, v_b</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co"># list of imputed data</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>data_1 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_1)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_2)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>data_3 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_3)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>data_4 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_4)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>data_5 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_5)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>data_1,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>data_2,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>data_3,</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>data_4,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>data_5</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="co"># create mplus object</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>mplus_model <span class="ot">&lt;-</span> MplusAutomation<span class="sc">::</span><span class="fu">mplusObject</span>(</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="at">MODEL =</span> <span class="st">&#39;</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="st">%WITHIN%</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="st">y on z_w;</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a><span class="st">%BETWEEN%</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="st">y on v_b;</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a><span class="st">y on z_b;</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="at">ANALYSIS =</span> <span class="st">&#39;</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a><span class="st">TYPE = COMPLEX TWOLEVEL;</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a><span class="st">ESTIMATOR = MLR;</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a><span class="st">PROCESSORS = 4;</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a><span class="at">VARIABLE =</span><span class="st">&#39;</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a><span class="st">STRATIFICATION = id_s;</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a><span class="st">CLUSTER  = id_j;</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a><span class="st">WEIGHT   = wi;</span></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a><span class="st">BWEIGHT  = wj;</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a><span class="st">WTSCALE  = ECLUSTER;</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a><span class="st">BWTSCALE = SAMPLE;</span></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a><span class="st">USEVARIABLES =</span></span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a><span class="st">y</span></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a><span class="st">z_w</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a><span class="st">v_b</span></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a><span class="st">z_b</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a><span class="st">;</span></span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a><span class="st">WITHIN  = z_w;</span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a><span class="st">BETWEEN = v_b z_b;</span></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a><span class="at">OUTPUT =</span><span class="st">&#39;</span></span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a><span class="st">STANDARDIZED</span></span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a><span class="st">CINTERVAL</span></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a><span class="st">RESIDUAL</span></span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a><span class="st">;</span></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a><span class="at">rdata =</span> data_list,</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a><span class="at">imputed =</span> <span class="cn">TRUE</span></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a><span class="co"># create list of data files</span></span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>mlm_model_data_list <span class="ot">&lt;-</span></span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_1.dat</span></span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_2.dat</span></span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_3.dat</span></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_4.dat</span></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_5.dat</span></span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a><span class="fu">write</span>(mlm_model_data_list, <span class="at">file=</span><span class="st">&quot;mlm.dat&quot;</span>, <span class="at">ncolumns=</span><span class="dv">1</span>)</span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="ot">&lt;-</span> MplusAutomation<span class="sc">::</span><span class="fu">mplusModeler</span>(mplus_model,</span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a>             <span class="at">modelout =</span> <span class="st">&#39;mlm.inp&#39;</span>,</span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a>             <span class="at">dataout =</span> <span class="st">&#39;mlm.dat&#39;</span>,</span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a>             <span class="at">run =</span> 1L,</span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a>             <span class="at">hashfilename =</span> <span class="cn">FALSE</span>,</span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a>             <span class="at">writeData =</span> <span class="st">&#39;always&#39;</span></span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a>             )</span></code></pre></div>
<pre><code>## The file(s)
##  &#39;mlm_imp_1.dat;
## mlm_imp_2.dat;
## mlm_imp_3.dat;
## mlm_imp_4.dat;
## mlm_imp_5.dat&#39; 
## currently exist(s) and will be overwritten</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># extract estimates</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>ci_00  <span class="ot">&lt;-</span> fit_4 <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;results&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;parameters&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;ci.unstandardized&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>          tibble<span class="sc">::</span><span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">term =</span> param)  <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">level  =</span> <span class="fu">tolower</span>(BetweenWithin)) <span class="sc">%&gt;%</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">ll   =</span> low2<span class="fl">.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">ul   =</span> up2<span class="fl">.5</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">paste0</span>(paramHeader, <span class="st">&quot;_&quot;</span>, term,<span class="st">&quot;_&quot;</span>,level)) <span class="sc">%&gt;%</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(index, ll, ul)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>r2_00  <span class="ot">&lt;-</span> fit_4 <span class="sc">%&gt;%</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;results&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;parameters&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;r2&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>          tibble<span class="sc">::</span><span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">level  =</span> <span class="fu">tolower</span>(BetweenWithin)) <span class="sc">%&gt;%</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">&#39;r2_w&#39;</span>, <span class="st">&#39;r2_b&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">object =</span> <span class="fu">c</span>(<span class="st">&#39;r2&#39;</span>, <span class="st">&#39;r2&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">e  =</span> <span class="fu">as.numeric</span>(est)) <span class="sc">%&gt;%</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">se =</span> <span class="fu">as.numeric</span>(se)) <span class="sc">%&gt;%</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">p  =</span> <span class="fu">as.numeric</span>(pval)) <span class="sc">%&gt;%</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">missing  =</span> <span class="fu">as.numeric</span>(rate_missing)) <span class="sc">%&gt;%</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">paste0</span>(term,<span class="st">&quot;_&quot;</span>,level)) <span class="sc">%&gt;%</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">control =</span> <span class="st">&#39;yes&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(index, level, object, term, e, se, p, missing, control)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>tabla_1_4 <span class="ot">&lt;-</span> fit_4 <span class="sc">%&gt;%</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>             purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;results&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>             purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;parameters&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>             purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;unstandardized&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>             tibble<span class="sc">::</span><span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">term =</span> param) <span class="sc">%&gt;%</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">level  =</span> <span class="fu">tolower</span>(BetweenWithin)) <span class="sc">%&gt;%</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">e  =</span> est) <span class="sc">%&gt;%</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">se =</span> se) <span class="sc">%&gt;%</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">p  =</span> pval) <span class="sc">%&gt;%</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">missing  =</span> rate_missing) <span class="sc">%&gt;%</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">paste0</span>(paramHeader, <span class="st">&quot;_&quot;</span>, term,<span class="st">&quot;_&quot;</span>,level)) <span class="sc">%&gt;%</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">left_join</span>(., ci_00, <span class="at">by =</span> <span class="st">&#39;index&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">control =</span> <span class="st">&#39;yes&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">object =</span> <span class="fu">c</span>(           <span class="st">&#39;pi_w&#39;</span>, <span class="st">&#39;epsilon&#39;</span>, </span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&#39;gamma_b&#39;</span>, <span class="st">&#39;pi_b&#39;</span>, <span class="st">&#39;alpha&#39;</span>, <span class="st">&#39;mu&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(., r2_00) <span class="sc">%&gt;%</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">select</span>(level, object, term, e, se, p, missing, ll, ul, control)</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a><span class="co"># display table</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>tabla_1_4 <span class="sc">%&gt;%</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">level</th>
<th align="left">object</th>
<th align="left">term</th>
<th align="right">e</th>
<th align="right">se</th>
<th align="right">p</th>
<th align="right">missing</th>
<th align="right">ll</th>
<th align="right">ul</th>
<th align="left">control</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">within</td>
<td align="left">pi_w</td>
<td align="left">Z_W</td>
<td align="right">12.51</td>
<td align="right">2.25</td>
<td align="right">0.00</td>
<td align="right">0.27</td>
<td align="right">8.09</td>
<td align="right">16.93</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">within</td>
<td align="left">epsilon</td>
<td align="left">Y</td>
<td align="right">4490.40</td>
<td align="right">167.57</td>
<td align="right">0.00</td>
<td align="right">0.35</td>
<td align="right">4161.96</td>
<td align="right">4818.85</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">gamma_b</td>
<td align="left">V_B</td>
<td align="right">22.51</td>
<td align="right">10.39</td>
<td align="right">0.03</td>
<td align="right">0.05</td>
<td align="right">2.14</td>
<td align="right">42.87</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">pi_b</td>
<td align="left">Z_B</td>
<td align="right">28.10</td>
<td align="right">6.91</td>
<td align="right">0.00</td>
<td align="right">0.12</td>
<td align="right">14.55</td>
<td align="right">41.65</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">alpha</td>
<td align="left">Y</td>
<td align="right">655.07</td>
<td align="right">4.60</td>
<td align="right">0.00</td>
<td align="right">0.15</td>
<td align="right">646.05</td>
<td align="right">664.08</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">mu</td>
<td align="left">Y</td>
<td align="right">2480.01</td>
<td align="right">471.29</td>
<td align="right">0.00</td>
<td align="right">0.10</td>
<td align="right">1556.29</td>
<td align="right">3403.74</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">within</td>
<td align="left">r2</td>
<td align="left">r2_w</td>
<td align="right">0.01</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
<td align="right">0.30</td>
<td align="right"></td>
<td align="right"></td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">r2</td>
<td align="left">r2_b</td>
<td align="right">0.18</td>
<td align="right">0.07</td>
<td align="right">0.01</td>
<td align="right">0.15</td>
<td align="right"></td>
<td align="right"></td>
<td align="left">yes</td>
</tr>
</tbody>
</table>
<h1 id="code-15-multilevel-model-with-svylme">Code 1.5 multilevel model
with <code>svylme</code></h1>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># multilevel model with svylme</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># configure R console</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">10</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># survey object</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>erce_svy2l <span class="ot">&lt;-</span> data_model <span class="sc">%&gt;%</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">filter</span>(ctry_name <span class="sc">==</span> <span class="st">&#39;Paraguay&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>              survey<span class="sc">::</span><span class="fu">svydesign</span>(</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">id =</span> <span class="sc">~</span> id_j <span class="sc">+</span> id_i,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">strata  =</span> <span class="sc">~</span>id_s,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> .,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">weights =</span> <span class="sc">~</span> wb1 <span class="sc">+</span> wb2</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>svylme_pv_results <span class="ot">&lt;-</span> mitools<span class="sc">::</span><span class="fu">withPV</span>(</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>   <span class="at">mapping =</span> mat <span class="sc">~</span> MAT_1 <span class="sc">+</span> MAT_2 <span class="sc">+</span> MAT_3 <span class="sc">+</span> MAT_4 <span class="sc">+</span> MAT_5, <span class="co">#&lt;&lt;</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> erce_svy2l,</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>   <span class="at">action =</span> <span class="fu">quote</span>(</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    svylme<span class="sc">::</span><span class="fu">svy2lme</span>(</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    mat <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> z_w <span class="sc">+</span> z_b <span class="sc">+</span> v_b <span class="sc">+</span> <span class="fu">as.factor</span>(id_s) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id_j),</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">sterr  =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&#39;nested&#39;</span>,</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">design =</span> erce_svy2l</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>   <span class="at">rewrite=</span><span class="cn">TRUE</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>   )</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="co"># create table</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>tabla_1_5 <span class="ot">&lt;-</span> erce<span class="sc">::</span><span class="fu">combine_reg</span>(svylme_pv_results)</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="co"># display table</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>tabla_1_5 <span class="sc">%&gt;%</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">e</th>
<th align="right">se</th>
<th align="right">p_val</th>
<th align="right">lo</th>
<th align="right">hi</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">632.82</td>
<td align="right">4.53</td>
<td align="right">0.00</td>
<td align="right">623.94</td>
<td align="right">641.70</td>
</tr>
<tr class="even">
<td align="left">z_w</td>
<td align="right">10.85</td>
<td align="right">3.19</td>
<td align="right">0.00</td>
<td align="right">4.57</td>
<td align="right">17.14</td>
</tr>
<tr class="odd">
<td align="left">z_b</td>
<td align="right">34.43</td>
<td align="right">9.47</td>
<td align="right">0.00</td>
<td align="right">15.86</td>
<td align="right">53.01</td>
</tr>
<tr class="even">
<td align="left">v_b</td>
<td align="right">16.20</td>
<td align="right">9.11</td>
<td align="right">0.08</td>
<td align="right">-1.66</td>
<td align="right">34.05</td>
</tr>
<tr class="odd">
<td align="left">as.factor(id_s)67</td>
<td align="right">32.58</td>
<td align="right">11.12</td>
<td align="right">0.00</td>
<td align="right">10.77</td>
<td align="right">54.39</td>
</tr>
<tr class="even">
<td align="left">as.factor(id_s)68</td>
<td align="right">38.99</td>
<td align="right">17.94</td>
<td align="right">0.03</td>
<td align="right">3.83</td>
<td align="right">74.15</td>
</tr>
<tr class="odd">
<td align="left">as.factor(id_s)69</td>
<td align="right">30.41</td>
<td align="right">14.82</td>
<td align="right">0.05</td>
<td align="right">-0.48</td>
<td align="right">61.30</td>
</tr>
<tr class="even">
<td align="left">as.factor(id_s)70</td>
<td align="right">37.65</td>
<td align="right">11.00</td>
<td align="right">0.00</td>
<td align="right">16.08</td>
<td align="right">59.23</td>
</tr>
<tr class="odd">
<td align="left">as.factor(id_s)71</td>
<td align="right">53.87</td>
<td align="right">50.41</td>
<td align="right">0.29</td>
<td align="right">-44.95</td>
<td align="right">152.68</td>
</tr>
<tr class="even">
<td align="left">as.factor(id_s)72</td>
<td align="right">-24.11</td>
<td align="right">12.87</td>
<td align="right">0.11</td>
<td align="right">-55.06</td>
<td align="right">6.83</td>
</tr>
</tbody>
</table>
<h1 id="code-16-multilevel-model-wemix">Code 1.6 multilevel model
<code>WeMix</code></h1>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># multilevel model with WeMix</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># configurar console</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">4</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># survey object</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>data_wemix <span class="ot">&lt;-</span> data_model <span class="sc">%&gt;%</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">filter</span>(ctry_name <span class="sc">==</span> <span class="st">&#39;Paraguay&#39;</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>wemix_pv_results <span class="ot">&lt;-</span> mitools<span class="sc">::</span><span class="fu">withPV</span>(</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>   <span class="at">mapping =</span> mat <span class="sc">~</span> MAT_1 <span class="sc">+</span> MAT_2 <span class="sc">+</span> MAT_3 <span class="sc">+</span> MAT_4 <span class="sc">+</span> MAT_5, <span class="co">#&lt;&lt;</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data_wemix,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>   <span class="at">action =</span> <span class="fu">quote</span>(</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>WeMix<span class="sc">::</span><span class="fu">mix</span>(</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  mat <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> z_w <span class="sc">+</span> z_b <span class="sc">+</span> v_b <span class="sc">+</span> <span class="fu">as.factor</span>(id_s) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id_j),</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_wemix,</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="fu">c</span>(<span class="st">&#39;wb1&#39;</span>,<span class="st">&#39;wb2&#39;</span>),</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">cWeights =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>   <span class="at">rewrite=</span><span class="cn">TRUE</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>   )</span></code></pre></div>
<pre><code>## Warning in WeMix::mix(MAT_1 ~ 1 + z_w + z_b + v_b + as.factor(id_s) + (1 | :
## There were 368 rows with missing data. These have been removed.

## Warning in WeMix::mix(MAT_2 ~ 1 + z_w + z_b + v_b + as.factor(id_s) + (1 | :
## There were 368 rows with missing data. These have been removed.

## Warning in WeMix::mix(MAT_3 ~ 1 + z_w + z_b + v_b + as.factor(id_s) + (1 | :
## There were 368 rows with missing data. These have been removed.

## Warning in WeMix::mix(MAT_4 ~ 1 + z_w + z_b + v_b + as.factor(id_s) + (1 | :
## There were 368 rows with missing data. These have been removed.

## Warning in WeMix::mix(MAT_5 ~ 1 + z_w + z_b + v_b + as.factor(id_s) + (1 | :
## There were 368 rows with missing data. These have been removed.</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create table</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>tabla_1_6 <span class="ot">&lt;-</span> <span class="fu">summary</span>(</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  miceadds<span class="sc">::</span><span class="fu">pool_mi</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">qhat =</span> <span class="fu">list</span>(</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">1</span>]]<span class="sc">$</span>coef,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">2</span>]]<span class="sc">$</span>coef,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">3</span>]]<span class="sc">$</span>coef,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">4</span>]]<span class="sc">$</span>coef,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">5</span>]]<span class="sc">$</span>coef</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">se   =</span> <span class="fu">list</span>(</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">1</span>]]<span class="sc">$</span>SE,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">2</span>]]<span class="sc">$</span>SE,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">3</span>]]<span class="sc">$</span>SE,</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">4</span>]]<span class="sc">$</span>SE,</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">5</span>]]<span class="sc">$</span>SE</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">as_tibble</span>()</span></code></pre></div>
<pre><code>## Multiple imputation results:
## Call: miceadds::pool_mi(qhat = list(wemix_pv_results[[1]]$coef, wemix_pv_results[[2]]$coef, 
##     wemix_pv_results[[3]]$coef, wemix_pv_results[[4]]$coef, wemix_pv_results[[5]]$coef), 
##     se = list(wemix_pv_results[[1]]$SE, wemix_pv_results[[2]]$SE, 
##         wemix_pv_results[[3]]$SE, wemix_pv_results[[4]]$SE, wemix_pv_results[[5]]$SE))
##                   results     se        t            p  (lower upper) missInfo
## (Intercept)        629.47  4.203 149.7575 0.0000000000 621.226 637.71    4.8 %
## z_w                 12.51  2.261   5.5340 0.0000006068   7.997  17.03   27.1 %
## z_b                 26.01  9.330   2.7882 0.0059586992   7.585  44.44   17.1 %
## v_b                 20.51  7.906   2.5938 0.0095786298   5.000  36.02    5.1 %
## as.factor(id_s)67   30.41 10.473   2.9033 0.0038703467   9.825  50.99    9.7 %
## as.factor(id_s)68   53.30 15.428   3.4550 0.0006213926  22.955  83.65   11.5 %
## as.factor(id_s)69   39.92 12.966   3.0789 0.0070359228  12.487  67.36   54.6 %
## as.factor(id_s)70   48.29  9.751   4.9518 0.0000008109  29.160  67.41      5 %
## as.factor(id_s)71   33.91 40.816   0.8308 0.4061726894 -46.130 113.95    4.3 %
## as.factor(id_s)72  -15.95 17.509  -0.9111 0.3673224780 -51.259  19.36   33.5 %</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># display table</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>tabla_1_6 <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">results</th>
<th align="right">se</th>
<th align="right">t</th>
<th align="right">p</th>
<th align="right">(lower</th>
<th align="right">upper)</th>
<th align="left">missInfo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">629.47</td>
<td align="right">4.20</td>
<td align="right">149.76</td>
<td align="right">0.00</td>
<td align="right">621.23</td>
<td align="right">637.71</td>
<td align="left">4.8 %</td>
</tr>
<tr class="even">
<td align="left">z_w</td>
<td align="right">12.51</td>
<td align="right">2.26</td>
<td align="right">5.53</td>
<td align="right">0.00</td>
<td align="right">8.00</td>
<td align="right">17.03</td>
<td align="left">27.1 %</td>
</tr>
<tr class="odd">
<td align="left">z_b</td>
<td align="right">26.01</td>
<td align="right">9.33</td>
<td align="right">2.79</td>
<td align="right">0.01</td>
<td align="right">7.58</td>
<td align="right">44.44</td>
<td align="left">17.1 %</td>
</tr>
<tr class="even">
<td align="left">v_b</td>
<td align="right">20.51</td>
<td align="right">7.91</td>
<td align="right">2.59</td>
<td align="right">0.01</td>
<td align="right">5.00</td>
<td align="right">36.02</td>
<td align="left">5.1 %</td>
</tr>
<tr class="odd">
<td align="left">as.factor(id_s)67</td>
<td align="right">30.41</td>
<td align="right">10.47</td>
<td align="right">2.90</td>
<td align="right">0.00</td>
<td align="right">9.83</td>
<td align="right">50.99</td>
<td align="left">9.7 %</td>
</tr>
<tr class="even">
<td align="left">as.factor(id_s)68</td>
<td align="right">53.30</td>
<td align="right">15.43</td>
<td align="right">3.45</td>
<td align="right">0.00</td>
<td align="right">22.95</td>
<td align="right">83.65</td>
<td align="left">11.5 %</td>
</tr>
<tr class="odd">
<td align="left">as.factor(id_s)69</td>
<td align="right">39.92</td>
<td align="right">12.97</td>
<td align="right">3.08</td>
<td align="right">0.01</td>
<td align="right">12.49</td>
<td align="right">67.36</td>
<td align="left">54.6 %</td>
</tr>
<tr class="even">
<td align="left">as.factor(id_s)70</td>
<td align="right">48.29</td>
<td align="right">9.75</td>
<td align="right">4.95</td>
<td align="right">0.00</td>
<td align="right">29.16</td>
<td align="right">67.41</td>
<td align="left">5 %</td>
</tr>
<tr class="odd">
<td align="left">as.factor(id_s)71</td>
<td align="right">33.91</td>
<td align="right">40.82</td>
<td align="right">0.83</td>
<td align="right">0.41</td>
<td align="right">-46.13</td>
<td align="right">113.95</td>
<td align="left">4.3 %</td>
</tr>
<tr class="even">
<td align="left">as.factor(id_s)72</td>
<td align="right">-15.95</td>
<td align="right">17.51</td>
<td align="right">-0.91</td>
<td align="right">0.37</td>
<td align="right">-51.26</td>
<td align="right">19.36</td>
<td align="left">33.5 %</td>
</tr>
</tbody>
</table>
<h1 id="code-17-modelo-multinivel-con-stata">Code 1.7 modelo multinivel
con <code>STATA</code></h1>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># multilevel model with Stata</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create data frame for Stata</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>data_stata <span class="ot">&lt;-</span> data_model <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(ctry_name <span class="sc">==</span> <span class="st">&#39;Paraguay&#39;</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co"># configure RStata library</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RStata)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&quot;RStata.StataPath&quot;</span><span class="ot">=</span><span class="st">&#39;/Applications/Stata/StataMP.app/Contents/MacOS/stata-mp&#39;</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&quot;RStata.StataVersion&quot;</span><span class="ot">=</span><span class="dv">15</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Stata code</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>stata_code <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="st">* ===============================================.</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="st">* define folder and open data</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="st">* ===============================================.</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="st">* ===============================.</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="st">* fit mlm model with @pv</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="st">* ===============================.</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="st">pv, pv(MAT_1 MAT_2 MAT_3 MAT_4 MAT_5): ///</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="st">mixed @pv               ///</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="st">z_w                     ///</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a><span class="st">z_b                     ///</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="st">v_b                     ///</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="st">i.id_s                  ///</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="st">[pw=wb1] || id_j:, ml pweight(wb2)</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a><span class="st">estimates store m01</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a><span class="st">* ===============================.</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a><span class="st">* variance</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="st">* ===============================.</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a><span class="st">/*return residual variance */</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a><span class="st">_diparm lnsig_e,  f(exp(@)^2) d(2*exp(@)^2)    </span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a><span class="st">/*return between  variance */</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a><span class="st">_diparm lns1_1_1, f(exp(@)^2) d(2*exp(@)^2)  </span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a><span class="st">* ===============================.</span></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a><span class="st">* estimates</span></span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a><span class="st">* ===============================.</span></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a><span class="st">esttab m01, b(%9.2f) se(%9.2f) wide transform(ln*: exp(2*@) exp(2*@))</span></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------</span></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a><span class="co"># display Stata results within R</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------</span></span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>RStata<span class="sc">::</span><span class="fu">stata</span>(stata_code, <span class="at">data.in =</span> data_stata)</span></code></pre></div>
<pre><code>## . 
## . 
## . * ===============================================.
## . * define folder and open data
## . * ===============================================.
## . 
## . * ===============================.
## . * fit mlm model with @pv
## . * ===============================.
## . 
## . pv, pv(MAT_1 MAT_2 MAT_3 MAT_4 MAT_5): ///
## &gt; mixed @pv               ///
## &gt; z_w                     ///
## &gt; z_b                     ///
## &gt; v_b                     ///
## &gt; i.id_s                  ///
## &gt; [pw=wb1] || id_j:, ml pweight(wb2)
## 
## command(s) run for each plausible value:
## 
##      mixed @pv               z_w                     z_b                     v_b                     i.id_s                  [pw=wb1] || id_j:, ml pweight(wb2)
## 
## Estimates for MAT_1   complete
## Estimates for MAT_2   complete
## Estimates for MAT_3   complete
## Estimates for MAT_4   complete
## Estimates for MAT_5   complete
## 
## Number of observations: 4481
## Average R-Squared: .
## 
## 
##                       Coef     Std Err           t     t Param       P&gt;|t|
##      MAT_5:z_w   12.512955   2.2611123   5.5339821           .           .
##      MAT_5:z_b   26.013356   9.3297681   2.7882103           .           .
##      MAT_5:v_b   20.507859   7.9064065   2.5938281           .           .
## MAT_5:66b.id_s           0           0           .           .           .
##  MAT_5:67.id_s   30.405715   10.472871   2.9032836           .           .
##  MAT_5:68.id_s   53.303288   15.427992   3.4549724           .           .
##  MAT_5:69.id_s    39.92108   12.965822    3.078947           .           .
##  MAT_5:70.id_s   48.286777   9.7514024   4.9517777           .           .
##  MAT_5:71.id_s   33.909887   40.815817   .83080261           .           .
##  MAT_5:72.id_s  -15.951792   17.508669  -.91107964           .           .
##    MAT_5:_cons   629.46964    4.203277   149.75688           .           .
## lns1_1_1:_cons   3.8361029   .10507108   36.509598           .           .
##  lnsig_e:_cons   4.2050067   .01882431   223.38176           .           .
## . estimates store m01
## . 
## . * ===============================.
## . * variance
## . * ===============================.
## . 
## . /*return residual variance */
## . _diparm lnsig_e,  f(exp(@)^2) d(2*exp(@)^2)    
##     /lnsig_e |   4491.821   169.1108                      4172.303    4835.807
## . /*return between  variance */
## . _diparm lns1_1_1, f(exp(@)^2) d(2*exp(@)^2)  
##    /lns1_1_1 |   2147.814   451.3463                      1422.733    3242.425
## . 
## . * ===============================.
## . * estimates
## . * ===============================.
## . 
## . esttab m01, b(%9.2f) se(%9.2f) wide transform(ln*: exp(2*@) exp(2*@))
## 
## -----------------------------------------
##                       (1)                
##                                          
## -----------------------------------------
## MAT_5                                    
## z_w                 12.51***       (2.26)
## z_b                 26.01**        (9.33)
## v_b                 20.51**        (7.91)
## 66.id_s              0.00             (.)
## 67.id_s             30.41**       (10.47)
## 68.id_s             53.30***      (15.43)
## 69.id_s             39.92**       (12.97)
## 70.id_s             48.29***       (9.75)
## 71.id_s             33.91         (40.82)
## 72.id_s            -15.95         (17.51)
## _cons              629.47***       (4.20)
## -----------------------------------------
## lns1_1_1                                 
## _cons             2147.81***     (225.67)
## -----------------------------------------
## lnsig_e                                  
## _cons             4491.82***      (84.56)
## -----------------------------------------
## N                    4481                
## -----------------------------------------
## Standard errors in parentheses
## * p&lt;0.05, ** p&lt;0.01, *** p&lt;0.001
## .</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create table with obtained results</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>tabla_1_7 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="at">text =</span> <span class="st">&quot;</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="st">variable            e          star       se</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="st">z_w                 12.51      &#39;***&#39;    2.26</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="st">z_b                 26.01      &#39;** &#39;    9.33</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="st">v_b                 20.51      &#39;** &#39;    7.91</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="st">66.id_s              0.00      &#39;   &#39;      NA</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="st">67.id_s             30.41      &#39;** &#39;   10.47</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="st">68.id_s             53.30      &#39;***&#39;   15.43</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="st">69.id_s             39.92      &#39;** &#39;   12.97</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="st">70.id_s             48.29      &#39;***&#39;    9.75</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="st">71.id_s             33.91      &#39;   &#39;   40.82</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="st">72.id_s            -15.95      &#39;   &#39;   17.51</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="st">_cons              629.47      &#39;***&#39;    4.20</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span>,</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co"># display table</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>tabla_1_7 <span class="sc">%&gt;%</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">variable</th>
<th align="right">e</th>
<th align="left">star</th>
<th align="right">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">z_w</td>
<td align="right">12.51</td>
<td align="left">***</td>
<td align="right">2.26</td>
</tr>
<tr class="even">
<td align="left">z_b</td>
<td align="right">26.01</td>
<td align="left">**</td>
<td align="right">9.33</td>
</tr>
<tr class="odd">
<td align="left">v_b</td>
<td align="right">20.51</td>
<td align="left">**</td>
<td align="right">7.91</td>
</tr>
<tr class="even">
<td align="left">66.id_s</td>
<td align="right">0.00</td>
<td align="left"></td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="left">67.id_s</td>
<td align="right">30.41</td>
<td align="left">**</td>
<td align="right">10.47</td>
</tr>
<tr class="even">
<td align="left">68.id_s</td>
<td align="right">53.30</td>
<td align="left">***</td>
<td align="right">15.43</td>
</tr>
<tr class="odd">
<td align="left">69.id_s</td>
<td align="right">39.92</td>
<td align="left">**</td>
<td align="right">12.97</td>
</tr>
<tr class="even">
<td align="left">70.id_s</td>
<td align="right">48.29</td>
<td align="left">***</td>
<td align="right">9.75</td>
</tr>
<tr class="odd">
<td align="left">71.id_s</td>
<td align="right">33.91</td>
<td align="left"></td>
<td align="right">40.82</td>
</tr>
<tr class="even">
<td align="left">72.id_s</td>
<td align="right">-15.95</td>
<td align="left"></td>
<td align="right">17.51</td>
</tr>
<tr class="odd">
<td align="left">_cons</td>
<td align="right">629.47</td>
<td align="left">***</td>
<td align="right">4.20</td>
</tr>
</tbody>
</table>
<h1 id="annexes-1-comparing-different-settings-with-mplus">Annexes 1:
comparing different settings with Mplus</h1>
<ul>
<li><p><code>fit_4</code> mixed model with survey weights (effective
sample size), including stratification information</p></li>
<li><p><code>fit_8</code> mixed model with survey weights (effective
sample size), including stratification information as fixed
effects</p></li>
<li><p><code>fit_9</code> mixed model with survey weights (effective
sample size) as provided by the user, including stratification
information as fixed effects</p></li>
<li><p><code>fit_10</code> mixed model with survey weights (normalized)
as provided by the user, including stratification information as fixed
effects</p></li>
<li><p><code>fit_11</code> mixed model without, including stratification
information as fixed effects</p></li>
</ul>
<h2 id="code-18-mixed-mode-with-mplus-with-strata-as-fixed-effects">Code
1.8 mixed mode with <code>Mplus</code>, with strata as fixed
effects</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mixe model with Mplus</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data for Mplus</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>data_mixed <span class="ot">&lt;-</span> data_model <span class="sc">%&gt;%</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">filter</span>(ctry_name <span class="sc">==</span> <span class="st">&#39;Paraguay&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rename_all</span>(tolower) <span class="sc">%&gt;%</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_1 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">66</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_2 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">67</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_3 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">68</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_4 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">69</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_5 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">70</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_6 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">71</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_7 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">72</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>              mat_1, mat_2, mat_3, mat_4, mat_5,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>              id_k, id_s, id_j, id_i,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>              wb1, wb2, wi, wj,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>              z_w, z_b, v_b,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="co">#              strat_1, # strata of reference</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>              strat_2,</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>              strat_3,</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>              strat_4,</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>              strat_5,</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>              strat_6,</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>              strat_7</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="co"># list of imputed data</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>data_1 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_1)</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_2)</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>data_3 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_3)</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>data_4 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_4)</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>data_5 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_5)</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>data_1,</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>data_2,</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>data_3,</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>data_4,</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>data_5</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a><span class="co"># create mplus object</span></span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>mplus_model <span class="ot">&lt;-</span> MplusAutomation<span class="sc">::</span><span class="fu">mplusObject</span>(</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a><span class="at">MODEL =</span> <span class="st">&#39;</span></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a><span class="st">%WITHIN%</span></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a><span class="st">y on z_w;</span></span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a><span class="st">%BETWEEN%</span></span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a><span class="st">y on v_b;</span></span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a><span class="st">y on z_b;</span></span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_2; </span></span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_3; </span></span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_4; </span></span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_5; </span></span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_6; </span></span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_7; </span></span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a><span class="at">ANALYSIS =</span> <span class="st">&#39;</span></span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a><span class="st">TYPE = TWOLEVEL;</span></span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a><span class="st">ESTIMATOR = MLR;</span></span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a><span class="st">PROCESSORS = 4;</span></span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a><span class="at">VARIABLE =</span><span class="st">&#39;</span></span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a><span class="st">CLUSTER  = id_j;</span></span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a><span class="st">WEIGHT   = wi;</span></span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a><span class="st">BWEIGHT  = wj;</span></span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a><span class="st">WTSCALE  = ECLUSTER;</span></span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a><span class="st">BWTSCALE = SAMPLE;</span></span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a><span class="st">USEVARIABLES =</span></span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a><span class="st">y</span></span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a><span class="st">z_w</span></span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a><span class="st">v_b</span></span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a><span class="st">z_b</span></span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a><span class="st">strat_2</span></span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a><span class="st">strat_3</span></span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a><span class="st">strat_4</span></span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a><span class="st">strat_5</span></span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a><span class="st">strat_6</span></span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a><span class="st">strat_7</span></span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a><span class="st">;</span></span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a><span class="st">WITHIN  = z_w;</span></span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a><span class="st">BETWEEN = v_b z_b strat_2-strat_7;</span></span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a><span class="at">OUTPUT =</span><span class="st">&#39;</span></span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a><span class="st">STANDARDIZED</span></span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a><span class="st">CINTERVAL</span></span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a><span class="st">RESIDUAL</span></span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a><span class="st">;</span></span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a><span class="at">rdata =</span> data_list,</span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a><span class="at">imputed =</span> <span class="cn">TRUE</span></span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-113"><a href="#cb18-113" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb18-114"><a href="#cb18-114" aria-hidden="true" tabindex="-1"></a><span class="co"># list of data files</span></span>
<span id="cb18-115"><a href="#cb18-115" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb18-116"><a href="#cb18-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-117"><a href="#cb18-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-118"><a href="#cb18-118" aria-hidden="true" tabindex="-1"></a>mlm_model_data_list <span class="ot">&lt;-</span></span>
<span id="cb18-119"><a href="#cb18-119" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb18-120"><a href="#cb18-120" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_1.dat</span></span>
<span id="cb18-121"><a href="#cb18-121" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_2.dat</span></span>
<span id="cb18-122"><a href="#cb18-122" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_3.dat</span></span>
<span id="cb18-123"><a href="#cb18-123" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_4.dat</span></span>
<span id="cb18-124"><a href="#cb18-124" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_5.dat</span></span>
<span id="cb18-125"><a href="#cb18-125" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb18-126"><a href="#cb18-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-127"><a href="#cb18-127" aria-hidden="true" tabindex="-1"></a><span class="fu">write</span>(mlm_model_data_list, <span class="at">file=</span><span class="st">&quot;mlm.dat&quot;</span>, <span class="at">ncolumns=</span><span class="dv">1</span>)</span>
<span id="cb18-128"><a href="#cb18-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-129"><a href="#cb18-129" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb18-130"><a href="#cb18-130" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb18-131"><a href="#cb18-131" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb18-132"><a href="#cb18-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-133"><a href="#cb18-133" aria-hidden="true" tabindex="-1"></a>fit_8 <span class="ot">&lt;-</span> MplusAutomation<span class="sc">::</span><span class="fu">mplusModeler</span>(mplus_model,</span>
<span id="cb18-134"><a href="#cb18-134" aria-hidden="true" tabindex="-1"></a>             <span class="at">modelout =</span> <span class="st">&#39;mlm.inp&#39;</span>,</span>
<span id="cb18-135"><a href="#cb18-135" aria-hidden="true" tabindex="-1"></a>             <span class="at">dataout =</span> <span class="st">&#39;mlm.dat&#39;</span>,</span>
<span id="cb18-136"><a href="#cb18-136" aria-hidden="true" tabindex="-1"></a>             <span class="at">run =</span> 1L,</span>
<span id="cb18-137"><a href="#cb18-137" aria-hidden="true" tabindex="-1"></a>             <span class="at">hashfilename =</span> <span class="cn">FALSE</span>,</span>
<span id="cb18-138"><a href="#cb18-138" aria-hidden="true" tabindex="-1"></a>             <span class="at">writeData =</span> <span class="st">&#39;always&#39;</span></span>
<span id="cb18-139"><a href="#cb18-139" aria-hidden="true" tabindex="-1"></a>             )</span></code></pre></div>
<pre><code>## The file(s)
##  &#39;mlm_imp_1.dat;
## mlm_imp_2.dat;
## mlm_imp_3.dat;
## mlm_imp_4.dat;
## mlm_imp_5.dat&#39; 
## currently exist(s) and will be overwritten</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># extract estimates</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>ci_00  <span class="ot">&lt;-</span> fit_8 <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;results&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;parameters&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;ci.unstandardized&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>          tibble<span class="sc">::</span><span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">term =</span> param)  <span class="sc">%&gt;%</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">level  =</span> <span class="fu">tolower</span>(BetweenWithin)) <span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">ll   =</span> low2<span class="fl">.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">ul   =</span> up2<span class="fl">.5</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">paste0</span>(paramHeader, <span class="st">&quot;_&quot;</span>, term,<span class="st">&quot;_&quot;</span>,level)) <span class="sc">%&gt;%</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(index, ll, ul)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>r2_00  <span class="ot">&lt;-</span> fit_8 <span class="sc">%&gt;%</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;results&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;parameters&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;r2&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>          tibble<span class="sc">::</span><span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">level  =</span> <span class="fu">tolower</span>(BetweenWithin)) <span class="sc">%&gt;%</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">&#39;r2_w&#39;</span>, <span class="st">&#39;r2_b&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">object =</span> <span class="fu">c</span>(<span class="st">&#39;r2&#39;</span>, <span class="st">&#39;r2&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">e  =</span> <span class="fu">as.numeric</span>(est)) <span class="sc">%&gt;%</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">se =</span> <span class="fu">as.numeric</span>(se)) <span class="sc">%&gt;%</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">p  =</span> <span class="fu">as.numeric</span>(pval)) <span class="sc">%&gt;%</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">missing  =</span> <span class="fu">as.numeric</span>(rate_missing)) <span class="sc">%&gt;%</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">paste0</span>(term,<span class="st">&quot;_&quot;</span>,level)) <span class="sc">%&gt;%</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">control =</span> <span class="st">&#39;yes&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(index, level, object, term, e, se, p, missing, control)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>tabla_1_8 <span class="ot">&lt;-</span> fit_8 <span class="sc">%&gt;%</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;results&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;parameters&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;unstandardized&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>          tibble<span class="sc">::</span><span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">term =</span> param) <span class="sc">%&gt;%</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">level  =</span> <span class="fu">tolower</span>(BetweenWithin)) <span class="sc">%&gt;%</span></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">e  =</span> est) <span class="sc">%&gt;%</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">se =</span> se) <span class="sc">%&gt;%</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">p  =</span> pval) <span class="sc">%&gt;%</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">missing  =</span> rate_missing) <span class="sc">%&gt;%</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">paste0</span>(paramHeader, <span class="st">&quot;_&quot;</span>, term,<span class="st">&quot;_&quot;</span>,level)) <span class="sc">%&gt;%</span></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">left_join</span>(., ci_00, <span class="at">by =</span> <span class="st">&#39;index&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">control =</span> <span class="st">&#39;yes&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">object =</span> <span class="fu">c</span>(           <span class="st">&#39;pi_w&#39;</span>, <span class="st">&#39;epsilon&#39;</span>, </span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;gamma_b&#39;</span>, <span class="st">&#39;pi_b&#39;</span>, </span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;delta_b1&#39;</span>,<span class="st">&#39;delta_b2&#39;</span>,<span class="st">&#39;delta_b3&#39;</span>,</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;delta_b4&#39;</span>,<span class="st">&#39;delta_b5&#39;</span>,<span class="st">&#39;delta_b6&#39;</span>,</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;alpha&#39;</span>, <span class="st">&#39;mu&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(., r2_00) <span class="sc">%&gt;%</span></span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(level, object, term, e, se, p, missing, ll, ul, control)</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a><span class="co"># display table</span></span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>tabla_1_8 <span class="sc">%&gt;%</span></span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">level</th>
<th align="left">object</th>
<th align="left">term</th>
<th align="right">e</th>
<th align="right">se</th>
<th align="right">p</th>
<th align="right">missing</th>
<th align="right">ll</th>
<th align="right">ul</th>
<th align="left">control</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">within</td>
<td align="left">pi_w</td>
<td align="left">Z_W</td>
<td align="right">12.51</td>
<td align="right">2.26</td>
<td align="right">0.00</td>
<td align="right">0.27</td>
<td align="right">8.09</td>
<td align="right">16.94</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">within</td>
<td align="left">epsilon</td>
<td align="left">Y</td>
<td align="right">4492.12</td>
<td align="right">169.39</td>
<td align="right">0.00</td>
<td align="right">0.35</td>
<td align="right">4160.11</td>
<td align="right">4824.12</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">gamma_b</td>
<td align="left">V_B</td>
<td align="right">20.52</td>
<td align="right">7.90</td>
<td align="right">0.01</td>
<td align="right">0.05</td>
<td align="right">5.03</td>
<td align="right">36.01</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">pi_b</td>
<td align="left">Z_B</td>
<td align="right">25.99</td>
<td align="right">9.36</td>
<td align="right">0.00</td>
<td align="right">0.17</td>
<td align="right">7.66</td>
<td align="right">44.33</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">delta_b1</td>
<td align="left">STRAT_2</td>
<td align="right">30.39</td>
<td align="right">10.46</td>
<td align="right">0.00</td>
<td align="right">0.10</td>
<td align="right">9.89</td>
<td align="right">50.89</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">delta_b2</td>
<td align="left">STRAT_3</td>
<td align="right">53.32</td>
<td align="right">15.42</td>
<td align="right">0.00</td>
<td align="right">0.11</td>
<td align="right">23.10</td>
<td align="right">83.53</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">delta_b3</td>
<td align="left">STRAT_4</td>
<td align="right">39.95</td>
<td align="right">12.97</td>
<td align="right">0.00</td>
<td align="right">0.54</td>
<td align="right">14.53</td>
<td align="right">65.37</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">delta_b4</td>
<td align="left">STRAT_5</td>
<td align="right">48.30</td>
<td align="right">9.77</td>
<td align="right">0.00</td>
<td align="right">0.05</td>
<td align="right">29.16</td>
<td align="right">67.44</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">delta_b5</td>
<td align="left">STRAT_6</td>
<td align="right">33.90</td>
<td align="right">40.72</td>
<td align="right">0.41</td>
<td align="right">0.04</td>
<td align="right">-45.91</td>
<td align="right">113.72</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">delta_b6</td>
<td align="left">STRAT_7</td>
<td align="right">-15.98</td>
<td align="right">17.46</td>
<td align="right">0.36</td>
<td align="right">0.33</td>
<td align="right">-50.22</td>
<td align="right">18.25</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">alpha</td>
<td align="left">Y</td>
<td align="right">629.46</td>
<td align="right">4.21</td>
<td align="right">0.00</td>
<td align="right">0.05</td>
<td align="right">621.22</td>
<td align="right">637.71</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">mu</td>
<td align="left">Y</td>
<td align="right">2155.03</td>
<td align="right">452.29</td>
<td align="right">0.00</td>
<td align="right">0.11</td>
<td align="right">1268.55</td>
<td align="right">3041.51</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">within</td>
<td align="left">r2</td>
<td align="left">r2_w</td>
<td align="right">0.01</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
<td align="right">0.30</td>
<td align="right"></td>
<td align="right"></td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">r2</td>
<td align="left">r2_b</td>
<td align="right">0.28</td>
<td align="right">0.07</td>
<td align="right">0.00</td>
<td align="right">0.20</td>
<td align="right"></td>
<td align="right"></td>
<td align="left">yes</td>
</tr>
</tbody>
</table>
<h2 id="code-19-mixed-model-with-mplus-strata-as-fixed-effects-using-provided-wb1-wb2">Code
1.9 mixed model with <code>Mplus</code>, strata as fixed effects, using
provided wb1, wb2</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mixed model with Mplus</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data for Mplus</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>data_mixed <span class="ot">&lt;-</span> data_model <span class="sc">%&gt;%</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">filter</span>(ctry_name <span class="sc">==</span> <span class="st">&#39;Paraguay&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rename_all</span>(tolower) <span class="sc">%&gt;%</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_1 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">66</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_2 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">67</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_3 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">68</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_4 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">69</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_5 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">70</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_6 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">71</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_7 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">72</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>              mat_1, mat_2, mat_3, mat_4, mat_5,</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>              id_k, id_s, id_j, id_i,</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>              wb1, wb2, wi, wj,</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>              z_w, z_b, v_b,</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="co">#              strat_1, # strata of reference</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>              strat_2,</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>              strat_3,</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>              strat_4,</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>              strat_5,</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>              strat_6,</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>              strat_7</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="co"># list of imputed data</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>data_1 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_1)</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_2)</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>data_3 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_3)</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>data_4 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_4)</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>data_5 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_5)</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>data_1,</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>data_2,</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>data_3,</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>data_4,</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>data_5</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a><span class="co"># create Mplus object</span></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>mplus_model <span class="ot">&lt;-</span> MplusAutomation<span class="sc">::</span><span class="fu">mplusObject</span>(</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a><span class="at">MODEL =</span> <span class="st">&#39;</span></span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a><span class="st">%WITHIN%</span></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a><span class="st">y on z_w;</span></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a><span class="st">%BETWEEN%</span></span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a><span class="st">y on v_b;</span></span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a><span class="st">y on z_b;</span></span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_2; </span></span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_3; </span></span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_4; </span></span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_5; </span></span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_6; </span></span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_7; </span></span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a><span class="at">ANALYSIS =</span> <span class="st">&#39;</span></span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a><span class="st">TYPE = TWOLEVEL;</span></span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a><span class="st">ESTIMATOR = MLR;</span></span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a><span class="st">PROCESSORS = 4;</span></span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a><span class="at">VARIABLE =</span><span class="st">&#39;</span></span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a><span class="st">CLUSTER  = id_j;</span></span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a><span class="st">WEIGHT   = wb1;</span></span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a><span class="st">BWEIGHT  = wb2;</span></span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a><span class="st">WTSCALE  = UNSCALED;</span></span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a><span class="st">BWTSCALE = UNSCALED;</span></span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a><span class="st">USEVARIABLES =</span></span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a><span class="st">y</span></span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a><span class="st">z_w</span></span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a><span class="st">v_b</span></span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a><span class="st">z_b</span></span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a><span class="st">strat_2</span></span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a><span class="st">strat_3</span></span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a><span class="st">strat_4</span></span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a><span class="st">strat_5</span></span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a><span class="st">strat_6</span></span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a><span class="st">strat_7</span></span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a><span class="st">;</span></span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a><span class="st">WITHIN  = z_w;</span></span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a><span class="st">BETWEEN = v_b z_b strat_2-strat_7;</span></span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb21-102"><a href="#cb21-102" aria-hidden="true" tabindex="-1"></a><span class="at">OUTPUT =</span><span class="st">&#39;</span></span>
<span id="cb21-103"><a href="#cb21-103" aria-hidden="true" tabindex="-1"></a><span class="st">STANDARDIZED</span></span>
<span id="cb21-104"><a href="#cb21-104" aria-hidden="true" tabindex="-1"></a><span class="st">CINTERVAL</span></span>
<span id="cb21-105"><a href="#cb21-105" aria-hidden="true" tabindex="-1"></a><span class="st">RESIDUAL</span></span>
<span id="cb21-106"><a href="#cb21-106" aria-hidden="true" tabindex="-1"></a><span class="st">;</span></span>
<span id="cb21-107"><a href="#cb21-107" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb21-108"><a href="#cb21-108" aria-hidden="true" tabindex="-1"></a><span class="at">rdata =</span> data_list,</span>
<span id="cb21-109"><a href="#cb21-109" aria-hidden="true" tabindex="-1"></a><span class="at">imputed =</span> <span class="cn">TRUE</span></span>
<span id="cb21-110"><a href="#cb21-110" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-111"><a href="#cb21-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-112"><a href="#cb21-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-113"><a href="#cb21-113" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb21-114"><a href="#cb21-114" aria-hidden="true" tabindex="-1"></a><span class="co"># list of data files</span></span>
<span id="cb21-115"><a href="#cb21-115" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb21-116"><a href="#cb21-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-117"><a href="#cb21-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-118"><a href="#cb21-118" aria-hidden="true" tabindex="-1"></a>mlm_model_data_list <span class="ot">&lt;-</span></span>
<span id="cb21-119"><a href="#cb21-119" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb21-120"><a href="#cb21-120" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_1.dat</span></span>
<span id="cb21-121"><a href="#cb21-121" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_2.dat</span></span>
<span id="cb21-122"><a href="#cb21-122" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_3.dat</span></span>
<span id="cb21-123"><a href="#cb21-123" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_4.dat</span></span>
<span id="cb21-124"><a href="#cb21-124" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_5.dat</span></span>
<span id="cb21-125"><a href="#cb21-125" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb21-126"><a href="#cb21-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-127"><a href="#cb21-127" aria-hidden="true" tabindex="-1"></a><span class="fu">write</span>(mlm_model_data_list, <span class="at">file=</span><span class="st">&quot;mlm.dat&quot;</span>, <span class="at">ncolumns=</span><span class="dv">1</span>)</span>
<span id="cb21-128"><a href="#cb21-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-129"><a href="#cb21-129" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb21-130"><a href="#cb21-130" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb21-131"><a href="#cb21-131" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb21-132"><a href="#cb21-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-133"><a href="#cb21-133" aria-hidden="true" tabindex="-1"></a>fit_9 <span class="ot">&lt;-</span> MplusAutomation<span class="sc">::</span><span class="fu">mplusModeler</span>(mplus_model,</span>
<span id="cb21-134"><a href="#cb21-134" aria-hidden="true" tabindex="-1"></a>             <span class="at">modelout =</span> <span class="st">&#39;mlm.inp&#39;</span>,</span>
<span id="cb21-135"><a href="#cb21-135" aria-hidden="true" tabindex="-1"></a>             <span class="at">dataout =</span> <span class="st">&#39;mlm.dat&#39;</span>,</span>
<span id="cb21-136"><a href="#cb21-136" aria-hidden="true" tabindex="-1"></a>             <span class="at">run =</span> 1L,</span>
<span id="cb21-137"><a href="#cb21-137" aria-hidden="true" tabindex="-1"></a>             <span class="at">hashfilename =</span> <span class="cn">FALSE</span>,</span>
<span id="cb21-138"><a href="#cb21-138" aria-hidden="true" tabindex="-1"></a>             <span class="at">writeData =</span> <span class="st">&#39;always&#39;</span></span>
<span id="cb21-139"><a href="#cb21-139" aria-hidden="true" tabindex="-1"></a>             )</span></code></pre></div>
<pre><code>## The file(s)
##  &#39;mlm_imp_1.dat;
## mlm_imp_2.dat;
## mlm_imp_3.dat;
## mlm_imp_4.dat;
## mlm_imp_5.dat&#39; 
## currently exist(s) and will be overwritten</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># extract estimates</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>ci_00  <span class="ot">&lt;-</span> fit_9 <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;results&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;parameters&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;ci.unstandardized&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>          tibble<span class="sc">::</span><span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">term =</span> param)  <span class="sc">%&gt;%</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">level  =</span> <span class="fu">tolower</span>(BetweenWithin)) <span class="sc">%&gt;%</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">ll   =</span> low2<span class="fl">.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">ul   =</span> up2<span class="fl">.5</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">paste0</span>(paramHeader, <span class="st">&quot;_&quot;</span>, term,<span class="st">&quot;_&quot;</span>,level)) <span class="sc">%&gt;%</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(index, ll, ul)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>r2_00  <span class="ot">&lt;-</span> fit_9 <span class="sc">%&gt;%</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;results&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;parameters&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;r2&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>          tibble<span class="sc">::</span><span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">level  =</span> <span class="fu">tolower</span>(BetweenWithin)) <span class="sc">%&gt;%</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">&#39;r2_w&#39;</span>, <span class="st">&#39;r2_b&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">object =</span> <span class="fu">c</span>(<span class="st">&#39;r2&#39;</span>, <span class="st">&#39;r2&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">e  =</span> <span class="fu">as.numeric</span>(est)) <span class="sc">%&gt;%</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">se =</span> <span class="fu">as.numeric</span>(se)) <span class="sc">%&gt;%</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">p  =</span> <span class="fu">as.numeric</span>(pval)) <span class="sc">%&gt;%</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">missing  =</span> <span class="fu">as.numeric</span>(rate_missing)) <span class="sc">%&gt;%</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">paste0</span>(term,<span class="st">&quot;_&quot;</span>,level)) <span class="sc">%&gt;%</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">control =</span> <span class="st">&#39;yes&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(index, level, object, term, e, se, p, missing, control)</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>tabla_1_9 <span class="ot">&lt;-</span> fit_9 <span class="sc">%&gt;%</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;results&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;parameters&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;unstandardized&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>          tibble<span class="sc">::</span><span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">term =</span> param) <span class="sc">%&gt;%</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">level  =</span> <span class="fu">tolower</span>(BetweenWithin)) <span class="sc">%&gt;%</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">e  =</span> est) <span class="sc">%&gt;%</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">se =</span> se) <span class="sc">%&gt;%</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">p  =</span> pval) <span class="sc">%&gt;%</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">missing  =</span> rate_missing) <span class="sc">%&gt;%</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">paste0</span>(paramHeader, <span class="st">&quot;_&quot;</span>, term,<span class="st">&quot;_&quot;</span>,level)) <span class="sc">%&gt;%</span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">left_join</span>(., ci_00, <span class="at">by =</span> <span class="st">&#39;index&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">control =</span> <span class="st">&#39;yes&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">object =</span> <span class="fu">c</span>(           <span class="st">&#39;pi_w&#39;</span>, <span class="st">&#39;epsilon&#39;</span>, </span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;gamma_b&#39;</span>, <span class="st">&#39;pi_b&#39;</span>, </span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;delta_b1&#39;</span>,<span class="st">&#39;delta_b2&#39;</span>,<span class="st">&#39;delta_b3&#39;</span>,</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;delta_b4&#39;</span>,<span class="st">&#39;delta_b5&#39;</span>,<span class="st">&#39;delta_b6&#39;</span>,</span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;alpha&#39;</span>, <span class="st">&#39;mu&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(., r2_00) <span class="sc">%&gt;%</span></span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(level, object, term, e, se, p, missing, ll, ul, control)</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a><span class="co"># display table</span></span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>tabla_1_9 <span class="sc">%&gt;%</span></span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">level</th>
<th align="left">object</th>
<th align="left">term</th>
<th align="right">e</th>
<th align="right">se</th>
<th align="right">p</th>
<th align="right">missing</th>
<th align="right">ll</th>
<th align="right">ul</th>
<th align="left">control</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">within</td>
<td align="left">pi_w</td>
<td align="left">Z_W</td>
<td align="right">12.51</td>
<td align="right">2.26</td>
<td align="right">0.00</td>
<td align="right">0.27</td>
<td align="right">8.09</td>
<td align="right">16.94</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">within</td>
<td align="left">epsilon</td>
<td align="left">Y</td>
<td align="right">4492.12</td>
<td align="right">169.39</td>
<td align="right">0.00</td>
<td align="right">0.35</td>
<td align="right">4160.12</td>
<td align="right">4824.12</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">gamma_b</td>
<td align="left">V_B</td>
<td align="right">20.52</td>
<td align="right">7.90</td>
<td align="right">0.01</td>
<td align="right">0.05</td>
<td align="right">5.03</td>
<td align="right">36.01</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">pi_b</td>
<td align="left">Z_B</td>
<td align="right">25.99</td>
<td align="right">9.36</td>
<td align="right">0.00</td>
<td align="right">0.17</td>
<td align="right">7.66</td>
<td align="right">44.33</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">delta_b1</td>
<td align="left">STRAT_2</td>
<td align="right">30.39</td>
<td align="right">10.46</td>
<td align="right">0.00</td>
<td align="right">0.10</td>
<td align="right">9.89</td>
<td align="right">50.89</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">delta_b2</td>
<td align="left">STRAT_3</td>
<td align="right">53.32</td>
<td align="right">15.42</td>
<td align="right">0.00</td>
<td align="right">0.11</td>
<td align="right">23.10</td>
<td align="right">83.53</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">delta_b3</td>
<td align="left">STRAT_4</td>
<td align="right">39.95</td>
<td align="right">12.97</td>
<td align="right">0.00</td>
<td align="right">0.54</td>
<td align="right">14.53</td>
<td align="right">65.37</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">delta_b4</td>
<td align="left">STRAT_5</td>
<td align="right">48.30</td>
<td align="right">9.77</td>
<td align="right">0.00</td>
<td align="right">0.05</td>
<td align="right">29.16</td>
<td align="right">67.44</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">delta_b5</td>
<td align="left">STRAT_6</td>
<td align="right">33.90</td>
<td align="right">40.72</td>
<td align="right">0.41</td>
<td align="right">0.04</td>
<td align="right">-45.92</td>
<td align="right">113.72</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">delta_b6</td>
<td align="left">STRAT_7</td>
<td align="right">-15.98</td>
<td align="right">17.46</td>
<td align="right">0.36</td>
<td align="right">0.33</td>
<td align="right">-50.22</td>
<td align="right">18.25</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">alpha</td>
<td align="left">Y</td>
<td align="right">629.46</td>
<td align="right">4.21</td>
<td align="right">0.00</td>
<td align="right">0.05</td>
<td align="right">621.22</td>
<td align="right">637.71</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">mu</td>
<td align="left">Y</td>
<td align="right">2155.03</td>
<td align="right">452.29</td>
<td align="right">0.00</td>
<td align="right">0.11</td>
<td align="right">1268.55</td>
<td align="right">3041.52</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">within</td>
<td align="left">r2</td>
<td align="left">r2_w</td>
<td align="right">0.01</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
<td align="right">0.30</td>
<td align="right"></td>
<td align="right"></td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">r2</td>
<td align="left">r2_b</td>
<td align="right">0.28</td>
<td align="right">0.07</td>
<td align="right">0.00</td>
<td align="right">0.20</td>
<td align="right"></td>
<td align="right"></td>
<td align="left">yes</td>
</tr>
</tbody>
</table>
<h2 id="code-110-mixed-model-with-mplus-strata-as-fixed-effects-using-provided-wa1-wa2">Code
1.10 mixed model with <code>Mplus</code>, strata as fixed effects, using
provided wa1, wa2</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mixed model with Mplus</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data for Mplus</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>data_mixed <span class="ot">&lt;-</span> data_model <span class="sc">%&gt;%</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">filter</span>(ctry_name <span class="sc">==</span> <span class="st">&#39;Paraguay&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rename_all</span>(tolower) <span class="sc">%&gt;%</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_1 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">66</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_2 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">67</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_3 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">68</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_4 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">69</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_5 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">70</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_6 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">71</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_7 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">72</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>              mat_1, mat_2, mat_3, mat_4, mat_5,</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>              id_k, id_s, id_j, id_i,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>              wa1, wa2, wi, wj,</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>              z_w, z_b, v_b,</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="co">#              strat_1, # strata of reference</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>              strat_2,</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>              strat_3,</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>              strat_4,</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>              strat_5,</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>              strat_6,</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>              strat_7</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a><span class="co"># list of imputed data</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>data_1 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_1)</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_2)</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>data_3 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_3)</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>data_4 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_4)</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>data_5 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_5)</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>data_1,</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>data_2,</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>data_3,</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>data_4,</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>data_5</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a><span class="co"># create Mplus object</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>mplus_model <span class="ot">&lt;-</span> MplusAutomation<span class="sc">::</span><span class="fu">mplusObject</span>(</span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a><span class="at">MODEL =</span> <span class="st">&#39;</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a><span class="st">%WITHIN%</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a><span class="st">y on z_w;</span></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a><span class="st">%BETWEEN%</span></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a><span class="st">y on v_b;</span></span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a><span class="st">y on z_b;</span></span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_2; </span></span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_3; </span></span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_4; </span></span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_5; </span></span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_6; </span></span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_7; </span></span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a><span class="at">ANALYSIS =</span> <span class="st">&#39;</span></span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a><span class="st">TYPE = TWOLEVEL;</span></span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a><span class="st">ESTIMATOR = MLR;</span></span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a><span class="st">PROCESSORS = 4;</span></span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a><span class="at">VARIABLE =</span><span class="st">&#39;</span></span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a><span class="st">CLUSTER  = id_j;</span></span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a><span class="st">WEIGHT   = wa1;</span></span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a><span class="st">BWEIGHT  = wa2;</span></span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a><span class="st">WTSCALE  = UNSCALED;</span></span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a><span class="st">BWTSCALE = UNSCALED;</span></span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a><span class="st">USEVARIABLES =</span></span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a><span class="st">y</span></span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a><span class="st">z_w</span></span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a><span class="st">v_b</span></span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a><span class="st">z_b</span></span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a><span class="st">strat_2</span></span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a><span class="st">strat_3</span></span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a><span class="st">strat_4</span></span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a><span class="st">strat_5</span></span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a><span class="st">strat_6</span></span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a><span class="st">strat_7</span></span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a><span class="st">;</span></span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a><span class="st">WITHIN  = z_w;</span></span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a><span class="st">BETWEEN = v_b z_b strat_2-strat_7;</span></span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a><span class="at">OUTPUT =</span><span class="st">&#39;</span></span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a><span class="st">STANDARDIZED</span></span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a><span class="st">CINTERVAL</span></span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a><span class="st">RESIDUAL</span></span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a><span class="st">;</span></span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a><span class="at">rdata =</span> data_list,</span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a><span class="at">imputed =</span> <span class="cn">TRUE</span></span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-111"><a href="#cb24-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-112"><a href="#cb24-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-113"><a href="#cb24-113" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb24-114"><a href="#cb24-114" aria-hidden="true" tabindex="-1"></a><span class="co"># list of data</span></span>
<span id="cb24-115"><a href="#cb24-115" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb24-116"><a href="#cb24-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-117"><a href="#cb24-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-118"><a href="#cb24-118" aria-hidden="true" tabindex="-1"></a>mlm_model_data_list <span class="ot">&lt;-</span></span>
<span id="cb24-119"><a href="#cb24-119" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb24-120"><a href="#cb24-120" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_1.dat</span></span>
<span id="cb24-121"><a href="#cb24-121" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_2.dat</span></span>
<span id="cb24-122"><a href="#cb24-122" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_3.dat</span></span>
<span id="cb24-123"><a href="#cb24-123" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_4.dat</span></span>
<span id="cb24-124"><a href="#cb24-124" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_5.dat</span></span>
<span id="cb24-125"><a href="#cb24-125" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb24-126"><a href="#cb24-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-127"><a href="#cb24-127" aria-hidden="true" tabindex="-1"></a><span class="fu">write</span>(mlm_model_data_list, <span class="at">file=</span><span class="st">&quot;mlm.dat&quot;</span>, <span class="at">ncolumns=</span><span class="dv">1</span>)</span>
<span id="cb24-128"><a href="#cb24-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-129"><a href="#cb24-129" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb24-130"><a href="#cb24-130" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb24-131"><a href="#cb24-131" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb24-132"><a href="#cb24-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-133"><a href="#cb24-133" aria-hidden="true" tabindex="-1"></a>fit_10 <span class="ot">&lt;-</span> MplusAutomation<span class="sc">::</span><span class="fu">mplusModeler</span>(mplus_model,</span>
<span id="cb24-134"><a href="#cb24-134" aria-hidden="true" tabindex="-1"></a>             <span class="at">modelout =</span> <span class="st">&#39;mlm.inp&#39;</span>,</span>
<span id="cb24-135"><a href="#cb24-135" aria-hidden="true" tabindex="-1"></a>             <span class="at">dataout =</span> <span class="st">&#39;mlm.dat&#39;</span>,</span>
<span id="cb24-136"><a href="#cb24-136" aria-hidden="true" tabindex="-1"></a>             <span class="at">run =</span> 1L,</span>
<span id="cb24-137"><a href="#cb24-137" aria-hidden="true" tabindex="-1"></a>             <span class="at">hashfilename =</span> <span class="cn">FALSE</span>,</span>
<span id="cb24-138"><a href="#cb24-138" aria-hidden="true" tabindex="-1"></a>             <span class="at">writeData =</span> <span class="st">&#39;always&#39;</span></span>
<span id="cb24-139"><a href="#cb24-139" aria-hidden="true" tabindex="-1"></a>             )</span></code></pre></div>
<pre><code>## The file(s)
##  &#39;mlm_imp_1.dat;
## mlm_imp_2.dat;
## mlm_imp_3.dat;
## mlm_imp_4.dat;
## mlm_imp_5.dat&#39; 
## currently exist(s) and will be overwritten</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># extract estimates</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>ci_00  <span class="ot">&lt;-</span> fit_10 <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;results&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;parameters&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;ci.unstandardized&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>          tibble<span class="sc">::</span><span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">term =</span> param)  <span class="sc">%&gt;%</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">level  =</span> <span class="fu">tolower</span>(BetweenWithin)) <span class="sc">%&gt;%</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">ll   =</span> low2<span class="fl">.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">ul   =</span> up2<span class="fl">.5</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">paste0</span>(paramHeader, <span class="st">&quot;_&quot;</span>, term,<span class="st">&quot;_&quot;</span>,level)) <span class="sc">%&gt;%</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(index, ll, ul)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>r2_00  <span class="ot">&lt;-</span> fit_10 <span class="sc">%&gt;%</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;results&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;parameters&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;r2&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>          tibble<span class="sc">::</span><span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">level  =</span> <span class="fu">tolower</span>(BetweenWithin)) <span class="sc">%&gt;%</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">&#39;r2_w&#39;</span>, <span class="st">&#39;r2_b&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">object =</span> <span class="fu">c</span>(<span class="st">&#39;r2&#39;</span>, <span class="st">&#39;r2&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">e  =</span> <span class="fu">as.numeric</span>(est)) <span class="sc">%&gt;%</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">se =</span> <span class="fu">as.numeric</span>(se)) <span class="sc">%&gt;%</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">p  =</span> <span class="fu">as.numeric</span>(pval)) <span class="sc">%&gt;%</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">missing  =</span> <span class="fu">as.numeric</span>(rate_missing)) <span class="sc">%&gt;%</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">paste0</span>(term,<span class="st">&quot;_&quot;</span>,level)) <span class="sc">%&gt;%</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">control =</span> <span class="st">&#39;yes&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(index, level, object, term, e, se, p, missing, control)</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>tabla_1_10 <span class="ot">&lt;-</span> fit_10 <span class="sc">%&gt;%</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;results&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;parameters&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;unstandardized&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>          tibble<span class="sc">::</span><span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">term =</span> param) <span class="sc">%&gt;%</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">level  =</span> <span class="fu">tolower</span>(BetweenWithin)) <span class="sc">%&gt;%</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">e  =</span> est) <span class="sc">%&gt;%</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">se =</span> se) <span class="sc">%&gt;%</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">p  =</span> pval) <span class="sc">%&gt;%</span></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">missing  =</span> rate_missing) <span class="sc">%&gt;%</span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">paste0</span>(paramHeader, <span class="st">&quot;_&quot;</span>, term,<span class="st">&quot;_&quot;</span>,level)) <span class="sc">%&gt;%</span></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">left_join</span>(., ci_00, <span class="at">by =</span> <span class="st">&#39;index&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">control =</span> <span class="st">&#39;yes&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">object =</span> <span class="fu">c</span>(           <span class="st">&#39;pi_w&#39;</span>, <span class="st">&#39;epsilon&#39;</span>, </span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;gamma_b&#39;</span>, <span class="st">&#39;pi_b&#39;</span>, </span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;delta_b1&#39;</span>,<span class="st">&#39;delta_b2&#39;</span>,<span class="st">&#39;delta_b3&#39;</span>,</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;delta_b4&#39;</span>,<span class="st">&#39;delta_b5&#39;</span>,<span class="st">&#39;delta_b6&#39;</span>,</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;alpha&#39;</span>, <span class="st">&#39;mu&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(., r2_00) <span class="sc">%&gt;%</span></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(level, object, term, e, se, p, missing, ll, ul, control)</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a><span class="co"># display estimates</span></span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>tabla_1_10 <span class="sc">%&gt;%</span></span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">level</th>
<th align="left">object</th>
<th align="left">term</th>
<th align="right">e</th>
<th align="right">se</th>
<th align="right">p</th>
<th align="right">missing</th>
<th align="right">ll</th>
<th align="right">ul</th>
<th align="left">control</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">within</td>
<td align="left">pi_w</td>
<td align="left">Z_W</td>
<td align="right">12.51</td>
<td align="right">2.26</td>
<td align="right">0.00</td>
<td align="right">0.27</td>
<td align="right">8.09</td>
<td align="right">16.94</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">within</td>
<td align="left">epsilon</td>
<td align="left">Y</td>
<td align="right">4492.12</td>
<td align="right">169.39</td>
<td align="right">0.00</td>
<td align="right">0.35</td>
<td align="right">4160.12</td>
<td align="right">4824.12</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">gamma_b</td>
<td align="left">V_B</td>
<td align="right">20.52</td>
<td align="right">7.90</td>
<td align="right">0.01</td>
<td align="right">0.05</td>
<td align="right">5.03</td>
<td align="right">36.01</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">pi_b</td>
<td align="left">Z_B</td>
<td align="right">25.99</td>
<td align="right">9.36</td>
<td align="right">0.00</td>
<td align="right">0.17</td>
<td align="right">7.66</td>
<td align="right">44.33</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">delta_b1</td>
<td align="left">STRAT_2</td>
<td align="right">30.39</td>
<td align="right">10.46</td>
<td align="right">0.00</td>
<td align="right">0.10</td>
<td align="right">9.89</td>
<td align="right">50.89</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">delta_b2</td>
<td align="left">STRAT_3</td>
<td align="right">53.32</td>
<td align="right">15.42</td>
<td align="right">0.00</td>
<td align="right">0.11</td>
<td align="right">23.10</td>
<td align="right">83.53</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">delta_b3</td>
<td align="left">STRAT_4</td>
<td align="right">39.95</td>
<td align="right">12.97</td>
<td align="right">0.00</td>
<td align="right">0.54</td>
<td align="right">14.53</td>
<td align="right">65.37</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">delta_b4</td>
<td align="left">STRAT_5</td>
<td align="right">48.30</td>
<td align="right">9.77</td>
<td align="right">0.00</td>
<td align="right">0.05</td>
<td align="right">29.16</td>
<td align="right">67.44</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">delta_b5</td>
<td align="left">STRAT_6</td>
<td align="right">33.90</td>
<td align="right">40.72</td>
<td align="right">0.41</td>
<td align="right">0.04</td>
<td align="right">-45.92</td>
<td align="right">113.72</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">delta_b6</td>
<td align="left">STRAT_7</td>
<td align="right">-15.98</td>
<td align="right">17.46</td>
<td align="right">0.36</td>
<td align="right">0.33</td>
<td align="right">-50.22</td>
<td align="right">18.25</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">alpha</td>
<td align="left">Y</td>
<td align="right">629.46</td>
<td align="right">4.21</td>
<td align="right">0.00</td>
<td align="right">0.05</td>
<td align="right">621.22</td>
<td align="right">637.71</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">mu</td>
<td align="left">Y</td>
<td align="right">2155.03</td>
<td align="right">452.29</td>
<td align="right">0.00</td>
<td align="right">0.11</td>
<td align="right">1268.55</td>
<td align="right">3041.52</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">within</td>
<td align="left">r2</td>
<td align="left">r2_w</td>
<td align="right">0.01</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
<td align="right">0.30</td>
<td align="right"></td>
<td align="right"></td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">r2</td>
<td align="left">r2_b</td>
<td align="right">0.28</td>
<td align="right">0.07</td>
<td align="right">0.00</td>
<td align="right">0.20</td>
<td align="right"></td>
<td align="right"></td>
<td align="left">yes</td>
</tr>
</tbody>
</table>
<h2 id="code-111-mixed-model-with-mplus-strata-as-fixed-effects-without-using-weights">Code
1.11 mixed model with <code>Mplus</code>, strata as fixed effects,
without using weights</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mixed model with Mplus</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data for Mplus</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>data_mixed <span class="ot">&lt;-</span> data_model <span class="sc">%&gt;%</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">filter</span>(ctry_name <span class="sc">==</span> <span class="st">&#39;Paraguay&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rename_all</span>(tolower) <span class="sc">%&gt;%</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_1 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">66</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_2 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">67</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_3 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">68</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_4 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">69</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_5 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">70</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_6 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">71</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">strat_7 =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(id_s <span class="sc">==</span> <span class="dv">72</span>, <span class="dv">1</span>, <span class="dv">0</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>              mat_1, mat_2, mat_3, mat_4, mat_5,</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>              id_k, id_s, id_j, id_i,</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>              wa1, wa2, wi, wj,</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>              z_w, z_b, v_b,</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="co">#              strat_1, # strata of reference</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>              strat_2,</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>              strat_3,</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>              strat_4,</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>              strat_5,</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>              strat_6,</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>              strat_7</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a><span class="co"># list of imputed data</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>data_1 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_1)</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_2)</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>data_3 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_3)</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>data_4 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_4)</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>data_5 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_5)</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>data_1,</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>data_2,</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>data_3,</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>data_4,</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>data_5</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a><span class="co"># create Mplus object</span></span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>mplus_model <span class="ot">&lt;-</span> MplusAutomation<span class="sc">::</span><span class="fu">mplusObject</span>(</span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a><span class="at">MODEL =</span> <span class="st">&#39;</span></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a><span class="st">%WITHIN%</span></span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a><span class="st">y on z_w;</span></span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a><span class="st">%BETWEEN%</span></span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a><span class="st">y on v_b;</span></span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a><span class="st">y on z_b;</span></span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_2; </span></span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_3; </span></span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_4; </span></span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_5; </span></span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_6; </span></span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a><span class="st">y on strat_7; </span></span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a><span class="at">ANALYSIS =</span> <span class="st">&#39;</span></span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a><span class="st">TYPE = TWOLEVEL;</span></span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a><span class="st">ESTIMATOR = MLR;</span></span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a><span class="st">PROCESSORS = 4;</span></span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a><span class="at">VARIABLE =</span><span class="st">&#39;</span></span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a><span class="st">CLUSTER  = id_j;</span></span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a><span class="st">!WEIGHT   = wa1;</span></span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a><span class="st">!BWEIGHT  = wa2;</span></span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a><span class="st">!WTSCALE  = UNSCALED;</span></span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a><span class="st">!BWTSCALE = UNSCALED;</span></span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a><span class="st">USEVARIABLES =</span></span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a><span class="st">y</span></span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a><span class="st">z_w</span></span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a><span class="st">v_b</span></span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a><span class="st">z_b</span></span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a><span class="st">strat_2</span></span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a><span class="st">strat_3</span></span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a><span class="st">strat_4</span></span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a><span class="st">strat_5</span></span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a><span class="st">strat_6</span></span>
<span id="cb27-95"><a href="#cb27-95" aria-hidden="true" tabindex="-1"></a><span class="st">strat_7</span></span>
<span id="cb27-96"><a href="#cb27-96" aria-hidden="true" tabindex="-1"></a><span class="st">;</span></span>
<span id="cb27-97"><a href="#cb27-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-98"><a href="#cb27-98" aria-hidden="true" tabindex="-1"></a><span class="st">WITHIN  = z_w;</span></span>
<span id="cb27-99"><a href="#cb27-99" aria-hidden="true" tabindex="-1"></a><span class="st">BETWEEN = v_b z_b strat_2-strat_7;</span></span>
<span id="cb27-100"><a href="#cb27-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-101"><a href="#cb27-101" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb27-102"><a href="#cb27-102" aria-hidden="true" tabindex="-1"></a><span class="at">OUTPUT =</span><span class="st">&#39;</span></span>
<span id="cb27-103"><a href="#cb27-103" aria-hidden="true" tabindex="-1"></a><span class="st">STANDARDIZED</span></span>
<span id="cb27-104"><a href="#cb27-104" aria-hidden="true" tabindex="-1"></a><span class="st">CINTERVAL</span></span>
<span id="cb27-105"><a href="#cb27-105" aria-hidden="true" tabindex="-1"></a><span class="st">RESIDUAL</span></span>
<span id="cb27-106"><a href="#cb27-106" aria-hidden="true" tabindex="-1"></a><span class="st">;</span></span>
<span id="cb27-107"><a href="#cb27-107" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb27-108"><a href="#cb27-108" aria-hidden="true" tabindex="-1"></a><span class="at">rdata =</span> data_list,</span>
<span id="cb27-109"><a href="#cb27-109" aria-hidden="true" tabindex="-1"></a><span class="at">imputed =</span> <span class="cn">TRUE</span></span>
<span id="cb27-110"><a href="#cb27-110" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-111"><a href="#cb27-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-112"><a href="#cb27-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-113"><a href="#cb27-113" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb27-114"><a href="#cb27-114" aria-hidden="true" tabindex="-1"></a><span class="co"># list of data files</span></span>
<span id="cb27-115"><a href="#cb27-115" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb27-116"><a href="#cb27-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-117"><a href="#cb27-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-118"><a href="#cb27-118" aria-hidden="true" tabindex="-1"></a>mlm_model_data_list <span class="ot">&lt;-</span></span>
<span id="cb27-119"><a href="#cb27-119" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb27-120"><a href="#cb27-120" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_1.dat</span></span>
<span id="cb27-121"><a href="#cb27-121" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_2.dat</span></span>
<span id="cb27-122"><a href="#cb27-122" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_3.dat</span></span>
<span id="cb27-123"><a href="#cb27-123" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_4.dat</span></span>
<span id="cb27-124"><a href="#cb27-124" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_5.dat</span></span>
<span id="cb27-125"><a href="#cb27-125" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb27-126"><a href="#cb27-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-127"><a href="#cb27-127" aria-hidden="true" tabindex="-1"></a><span class="fu">write</span>(mlm_model_data_list, <span class="at">file=</span><span class="st">&quot;mlm.dat&quot;</span>, <span class="at">ncolumns=</span><span class="dv">1</span>)</span>
<span id="cb27-128"><a href="#cb27-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-129"><a href="#cb27-129" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb27-130"><a href="#cb27-130" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb27-131"><a href="#cb27-131" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb27-132"><a href="#cb27-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-133"><a href="#cb27-133" aria-hidden="true" tabindex="-1"></a>fit_11 <span class="ot">&lt;-</span> MplusAutomation<span class="sc">::</span><span class="fu">mplusModeler</span>(mplus_model,</span>
<span id="cb27-134"><a href="#cb27-134" aria-hidden="true" tabindex="-1"></a>             <span class="at">modelout =</span> <span class="st">&#39;mlm.inp&#39;</span>,</span>
<span id="cb27-135"><a href="#cb27-135" aria-hidden="true" tabindex="-1"></a>             <span class="at">dataout =</span> <span class="st">&#39;mlm.dat&#39;</span>,</span>
<span id="cb27-136"><a href="#cb27-136" aria-hidden="true" tabindex="-1"></a>             <span class="at">run =</span> 1L,</span>
<span id="cb27-137"><a href="#cb27-137" aria-hidden="true" tabindex="-1"></a>             <span class="at">hashfilename =</span> <span class="cn">FALSE</span>,</span>
<span id="cb27-138"><a href="#cb27-138" aria-hidden="true" tabindex="-1"></a>             <span class="at">writeData =</span> <span class="st">&#39;always&#39;</span></span>
<span id="cb27-139"><a href="#cb27-139" aria-hidden="true" tabindex="-1"></a>             )</span></code></pre></div>
<pre><code>## The file(s)
##  &#39;mlm_imp_1.dat;
## mlm_imp_2.dat;
## mlm_imp_3.dat;
## mlm_imp_4.dat;
## mlm_imp_5.dat&#39; 
## currently exist(s) and will be overwritten</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># extract estimates</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>ci_00  <span class="ot">&lt;-</span> fit_11 <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;results&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;parameters&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;ci.unstandardized&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>          tibble<span class="sc">::</span><span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">term =</span> param)  <span class="sc">%&gt;%</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">level  =</span> <span class="fu">tolower</span>(BetweenWithin)) <span class="sc">%&gt;%</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">ll   =</span> low2<span class="fl">.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">ul   =</span> up2<span class="fl">.5</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">paste0</span>(paramHeader, <span class="st">&quot;_&quot;</span>, term,<span class="st">&quot;_&quot;</span>,level)) <span class="sc">%&gt;%</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(index, ll, ul)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>r2_00  <span class="ot">&lt;-</span> fit_11 <span class="sc">%&gt;%</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;results&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;parameters&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;r2&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>          tibble<span class="sc">::</span><span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">level  =</span> <span class="fu">tolower</span>(BetweenWithin)) <span class="sc">%&gt;%</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">&#39;r2_w&#39;</span>, <span class="st">&#39;r2_b&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">object =</span> <span class="fu">c</span>(<span class="st">&#39;r2&#39;</span>, <span class="st">&#39;r2&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">e  =</span> <span class="fu">as.numeric</span>(est)) <span class="sc">%&gt;%</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">se =</span> <span class="fu">as.numeric</span>(se)) <span class="sc">%&gt;%</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">p  =</span> <span class="fu">as.numeric</span>(pval)) <span class="sc">%&gt;%</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">missing  =</span> <span class="fu">as.numeric</span>(rate_missing)) <span class="sc">%&gt;%</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">paste0</span>(term,<span class="st">&quot;_&quot;</span>,level)) <span class="sc">%&gt;%</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">control =</span> <span class="st">&#39;yes&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(index, level, object, term, e, se, p, missing, control)</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>tabla_1_11 <span class="ot">&lt;-</span> fit_11 <span class="sc">%&gt;%</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;results&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;parameters&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;unstandardized&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>          tibble<span class="sc">::</span><span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">term =</span> param) <span class="sc">%&gt;%</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">level  =</span> <span class="fu">tolower</span>(BetweenWithin)) <span class="sc">%&gt;%</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">e  =</span> est) <span class="sc">%&gt;%</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">se =</span> se) <span class="sc">%&gt;%</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">p  =</span> pval) <span class="sc">%&gt;%</span></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">missing  =</span> rate_missing) <span class="sc">%&gt;%</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">paste0</span>(paramHeader, <span class="st">&quot;_&quot;</span>, term,<span class="st">&quot;_&quot;</span>,level)) <span class="sc">%&gt;%</span></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">left_join</span>(., ci_00, <span class="at">by =</span> <span class="st">&#39;index&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">control =</span> <span class="st">&#39;yes&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">object =</span> <span class="fu">c</span>(           <span class="st">&#39;pi_w&#39;</span>, <span class="st">&#39;epsilon&#39;</span>, </span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;gamma_b&#39;</span>, <span class="st">&#39;pi_b&#39;</span>, </span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;delta_b1&#39;</span>,<span class="st">&#39;delta_b2&#39;</span>,<span class="st">&#39;delta_b3&#39;</span>,</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;delta_b4&#39;</span>,<span class="st">&#39;delta_b5&#39;</span>,<span class="st">&#39;delta_b6&#39;</span>,</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&#39;alpha&#39;</span>, <span class="st">&#39;mu&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(., r2_00) <span class="sc">%&gt;%</span></span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(level, object, term, e, se, p, missing, ll, ul, control)</span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a><span class="co"># display estimates</span></span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>tabla_1_11 <span class="sc">%&gt;%</span></span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">level</th>
<th align="left">object</th>
<th align="left">term</th>
<th align="right">e</th>
<th align="right">se</th>
<th align="right">p</th>
<th align="right">missing</th>
<th align="right">ll</th>
<th align="right">ul</th>
<th align="left">control</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">within</td>
<td align="left">pi_w</td>
<td align="left">Z_W</td>
<td align="right">12.69</td>
<td align="right">1.79</td>
<td align="right">0.00</td>
<td align="right">0.37</td>
<td align="right">9.19</td>
<td align="right">16.19</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">within</td>
<td align="left">epsilon</td>
<td align="left">Y</td>
<td align="right">4579.00</td>
<td align="right">121.29</td>
<td align="right">0.00</td>
<td align="right">0.13</td>
<td align="right">4341.28</td>
<td align="right">4816.72</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">gamma_b</td>
<td align="left">V_B</td>
<td align="right">11.96</td>
<td align="right">5.98</td>
<td align="right">0.05</td>
<td align="right">0.01</td>
<td align="right">0.23</td>
<td align="right">23.68</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">pi_b</td>
<td align="left">Z_B</td>
<td align="right">42.73</td>
<td align="right">8.74</td>
<td align="right">0.00</td>
<td align="right">0.07</td>
<td align="right">25.60</td>
<td align="right">59.86</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">delta_b1</td>
<td align="left">STRAT_2</td>
<td align="right">27.09</td>
<td align="right">8.12</td>
<td align="right">0.00</td>
<td align="right">0.03</td>
<td align="right">11.18</td>
<td align="right">43.00</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">delta_b2</td>
<td align="left">STRAT_3</td>
<td align="right">36.99</td>
<td align="right">11.94</td>
<td align="right">0.00</td>
<td align="right">0.04</td>
<td align="right">13.60</td>
<td align="right">60.39</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">delta_b3</td>
<td align="left">STRAT_4</td>
<td align="right">22.30</td>
<td align="right">11.54</td>
<td align="right">0.05</td>
<td align="right">0.54</td>
<td align="right">-0.31</td>
<td align="right">44.92</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">delta_b4</td>
<td align="left">STRAT_5</td>
<td align="right">38.33</td>
<td align="right">8.40</td>
<td align="right">0.00</td>
<td align="right">0.02</td>
<td align="right">21.86</td>
<td align="right">54.79</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">delta_b5</td>
<td align="left">STRAT_6</td>
<td align="right">35.57</td>
<td align="right">33.14</td>
<td align="right">0.28</td>
<td align="right">0.04</td>
<td align="right">-29.38</td>
<td align="right">100.52</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">delta_b6</td>
<td align="left">STRAT_7</td>
<td align="right">10.38</td>
<td align="right">36.81</td>
<td align="right">0.78</td>
<td align="right">0.09</td>
<td align="right">-61.77</td>
<td align="right">82.53</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">alpha</td>
<td align="left">Y</td>
<td align="right">637.36</td>
<td align="right">3.36</td>
<td align="right">0.00</td>
<td align="right">0.11</td>
<td align="right">630.77</td>
<td align="right">643.94</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">mu</td>
<td align="left">Y</td>
<td align="right">1534.32</td>
<td align="right">276.14</td>
<td align="right">0.00</td>
<td align="right">0.04</td>
<td align="right">993.09</td>
<td align="right">2075.56</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">within</td>
<td align="left">r2</td>
<td align="left">r2_w</td>
<td align="right">0.02</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.38</td>
<td align="right"></td>
<td align="right"></td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">r2</td>
<td align="left">r2_b</td>
<td align="right">0.45</td>
<td align="right">0.07</td>
<td align="right">0.00</td>
<td align="right">0.06</td>
<td align="right"></td>
<td align="right"></td>
<td align="left">yes</td>
</tr>
</tbody>
</table>
<h2 id="code-112-mixed-model-with-mplus-without-sampling-information">Code
1.12 mixed model with <code>Mplus</code>, without sampling
information</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mixed model with Mplus</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data for Mplus</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>data_mixed <span class="ot">&lt;-</span> data_model <span class="sc">%&gt;%</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">filter</span>(ctry_name <span class="sc">==</span> <span class="st">&#39;Paraguay&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rename_all</span>(tolower) <span class="sc">%&gt;%</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>              mat_1, mat_2, mat_3, mat_4, mat_5,</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>              id_k, id_s, id_j, id_i,</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>              wb1, wb2, wi, wj,</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>              z_w, z_b, v_b</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="co"># list of imputed data</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>data_1 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_1)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_2)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>data_3 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_3)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>data_4 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_4)</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>data_5 <span class="ot">&lt;-</span> data_mixed <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">y =</span> mat_5)</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>data_1,</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>data_2,</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>data_3,</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>data_4,</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>data_5</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a><span class="co"># create Mplus object</span></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>mplus_model <span class="ot">&lt;-</span> MplusAutomation<span class="sc">::</span><span class="fu">mplusObject</span>(</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a><span class="at">MODEL =</span> <span class="st">&#39;</span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a><span class="st">%WITHIN%</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a><span class="st">y on z_w;</span></span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a><span class="st">%BETWEEN%</span></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a><span class="st">y on v_b;</span></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a><span class="st">y on z_b;</span></span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a><span class="at">ANALYSIS =</span> <span class="st">&#39;</span></span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a><span class="st">TYPE = TWOLEVEL;</span></span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a><span class="st">ESTIMATOR = MLR;</span></span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a><span class="st">PROCESSORS = 4;</span></span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a><span class="at">VARIABLE =</span><span class="st">&#39;</span></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a><span class="st">CLUSTER  = id_j;</span></span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a><span class="st">WEIGHT   = wi;</span></span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a><span class="st">BWEIGHT  = wj;</span></span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a><span class="st">WTSCALE  = ECLUSTER;</span></span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a><span class="st">BWTSCALE = SAMPLE;</span></span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a><span class="st">USEVARIABLES =</span></span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a><span class="st">y</span></span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a><span class="st">z_w</span></span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a><span class="st">v_b</span></span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a><span class="st">z_b</span></span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a><span class="st">;</span></span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a><span class="st">WITHIN  = z_w;</span></span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a><span class="st">BETWEEN = v_b z_b;</span></span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-75"><a href="#cb30-75" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb30-76"><a href="#cb30-76" aria-hidden="true" tabindex="-1"></a><span class="at">OUTPUT =</span><span class="st">&#39;</span></span>
<span id="cb30-77"><a href="#cb30-77" aria-hidden="true" tabindex="-1"></a><span class="st">STANDARDIZED</span></span>
<span id="cb30-78"><a href="#cb30-78" aria-hidden="true" tabindex="-1"></a><span class="st">CINTERVAL</span></span>
<span id="cb30-79"><a href="#cb30-79" aria-hidden="true" tabindex="-1"></a><span class="st">RESIDUAL</span></span>
<span id="cb30-80"><a href="#cb30-80" aria-hidden="true" tabindex="-1"></a><span class="st">;</span></span>
<span id="cb30-81"><a href="#cb30-81" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>,</span>
<span id="cb30-82"><a href="#cb30-82" aria-hidden="true" tabindex="-1"></a><span class="at">rdata =</span> data_list,</span>
<span id="cb30-83"><a href="#cb30-83" aria-hidden="true" tabindex="-1"></a><span class="at">imputed =</span> <span class="cn">TRUE</span></span>
<span id="cb30-84"><a href="#cb30-84" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-85"><a href="#cb30-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-86"><a href="#cb30-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-87"><a href="#cb30-87" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb30-88"><a href="#cb30-88" aria-hidden="true" tabindex="-1"></a><span class="co"># list of data</span></span>
<span id="cb30-89"><a href="#cb30-89" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb30-90"><a href="#cb30-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-91"><a href="#cb30-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-92"><a href="#cb30-92" aria-hidden="true" tabindex="-1"></a>mlm_model_data_list <span class="ot">&lt;-</span></span>
<span id="cb30-93"><a href="#cb30-93" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb30-94"><a href="#cb30-94" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_1.dat</span></span>
<span id="cb30-95"><a href="#cb30-95" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_2.dat</span></span>
<span id="cb30-96"><a href="#cb30-96" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_3.dat</span></span>
<span id="cb30-97"><a href="#cb30-97" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_4.dat</span></span>
<span id="cb30-98"><a href="#cb30-98" aria-hidden="true" tabindex="-1"></a><span class="st">mlm_imp_5.dat</span></span>
<span id="cb30-99"><a href="#cb30-99" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb30-100"><a href="#cb30-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-101"><a href="#cb30-101" aria-hidden="true" tabindex="-1"></a><span class="fu">write</span>(mlm_model_data_list, <span class="at">file=</span><span class="st">&quot;mlm.dat&quot;</span>, <span class="at">ncolumns=</span><span class="dv">1</span>)</span>
<span id="cb30-102"><a href="#cb30-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-103"><a href="#cb30-103" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb30-104"><a href="#cb30-104" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models</span></span>
<span id="cb30-105"><a href="#cb30-105" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb30-106"><a href="#cb30-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-107"><a href="#cb30-107" aria-hidden="true" tabindex="-1"></a>fit_12 <span class="ot">&lt;-</span> MplusAutomation<span class="sc">::</span><span class="fu">mplusModeler</span>(mplus_model,</span>
<span id="cb30-108"><a href="#cb30-108" aria-hidden="true" tabindex="-1"></a>             <span class="at">modelout =</span> <span class="st">&#39;mlm.inp&#39;</span>,</span>
<span id="cb30-109"><a href="#cb30-109" aria-hidden="true" tabindex="-1"></a>             <span class="at">dataout =</span> <span class="st">&#39;mlm.dat&#39;</span>,</span>
<span id="cb30-110"><a href="#cb30-110" aria-hidden="true" tabindex="-1"></a>             <span class="at">run =</span> 1L,</span>
<span id="cb30-111"><a href="#cb30-111" aria-hidden="true" tabindex="-1"></a>             <span class="at">hashfilename =</span> <span class="cn">FALSE</span>,</span>
<span id="cb30-112"><a href="#cb30-112" aria-hidden="true" tabindex="-1"></a>             <span class="at">writeData =</span> <span class="st">&#39;always&#39;</span></span>
<span id="cb30-113"><a href="#cb30-113" aria-hidden="true" tabindex="-1"></a>             )</span></code></pre></div>
<pre><code>## The file(s)
##  &#39;mlm_imp_1.dat;
## mlm_imp_2.dat;
## mlm_imp_3.dat;
## mlm_imp_4.dat;
## mlm_imp_5.dat&#39; 
## currently exist(s) and will be overwritten</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># extract estimates</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>ci_00  <span class="ot">&lt;-</span> fit_12 <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;results&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;parameters&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;ci.unstandardized&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>          tibble<span class="sc">::</span><span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">term =</span> param)  <span class="sc">%&gt;%</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">level  =</span> <span class="fu">tolower</span>(BetweenWithin)) <span class="sc">%&gt;%</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">ll   =</span> low2<span class="fl">.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">ul   =</span> up2<span class="fl">.5</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">paste0</span>(paramHeader, <span class="st">&quot;_&quot;</span>, term,<span class="st">&quot;_&quot;</span>,level)) <span class="sc">%&gt;%</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(index, ll, ul)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>r2_00  <span class="ot">&lt;-</span> fit_12 <span class="sc">%&gt;%</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;results&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;parameters&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;r2&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>          tibble<span class="sc">::</span><span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">level  =</span> <span class="fu">tolower</span>(BetweenWithin)) <span class="sc">%&gt;%</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">c</span>(<span class="st">&#39;r2_w&#39;</span>, <span class="st">&#39;r2_b&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">object =</span> <span class="fu">c</span>(<span class="st">&#39;r2&#39;</span>, <span class="st">&#39;r2&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">e  =</span> <span class="fu">as.numeric</span>(est)) <span class="sc">%&gt;%</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">se =</span> <span class="fu">as.numeric</span>(se)) <span class="sc">%&gt;%</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">p  =</span> <span class="fu">as.numeric</span>(pval)) <span class="sc">%&gt;%</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">missing  =</span> <span class="fu">as.numeric</span>(rate_missing)) <span class="sc">%&gt;%</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">paste0</span>(term,<span class="st">&quot;_&quot;</span>,level)) <span class="sc">%&gt;%</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">control =</span> <span class="st">&#39;yes&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(index, level, object, term, e, se, p, missing, control)</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>tabla_1_12 <span class="ot">&lt;-</span> fit_12 <span class="sc">%&gt;%</span></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>             purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;results&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>             purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;parameters&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>             purrr<span class="sc">::</span><span class="fu">pluck</span>(<span class="st">&#39;unstandardized&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>             tibble<span class="sc">::</span><span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">term =</span> param) <span class="sc">%&gt;%</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">level  =</span> <span class="fu">tolower</span>(BetweenWithin)) <span class="sc">%&gt;%</span></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">e  =</span> est) <span class="sc">%&gt;%</span></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">se =</span> se) <span class="sc">%&gt;%</span></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">p  =</span> pval) <span class="sc">%&gt;%</span></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">missing  =</span> rate_missing) <span class="sc">%&gt;%</span></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">paste0</span>(paramHeader, <span class="st">&quot;_&quot;</span>, term,<span class="st">&quot;_&quot;</span>,level)) <span class="sc">%&gt;%</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">left_join</span>(., ci_00, <span class="at">by =</span> <span class="st">&#39;index&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">control =</span> <span class="st">&#39;yes&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">object =</span> <span class="fu">c</span>(           <span class="st">&#39;pi_w&#39;</span>, <span class="st">&#39;epsilon&#39;</span>, </span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&#39;gamma_b&#39;</span>, <span class="st">&#39;pi_b&#39;</span>, <span class="st">&#39;alpha&#39;</span>, <span class="st">&#39;mu&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(., r2_00) <span class="sc">%&gt;%</span></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>             dplyr<span class="sc">::</span><span class="fu">select</span>(level, object, term, e, se, p, missing, ll, ul, control)</span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Display table</span></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>tabla_1_12 <span class="sc">%&gt;%</span></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">level</th>
<th align="left">object</th>
<th align="left">term</th>
<th align="right">e</th>
<th align="right">se</th>
<th align="right">p</th>
<th align="right">missing</th>
<th align="right">ll</th>
<th align="right">ul</th>
<th align="left">control</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">within</td>
<td align="left">pi_w</td>
<td align="left">Z_W</td>
<td align="right">12.51</td>
<td align="right">2.26</td>
<td align="right">0.00</td>
<td align="right">0.27</td>
<td align="right">8.09</td>
<td align="right">16.94</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">within</td>
<td align="left">epsilon</td>
<td align="left">Y</td>
<td align="right">4490.40</td>
<td align="right">168.40</td>
<td align="right">0.00</td>
<td align="right">0.34</td>
<td align="right">4160.33</td>
<td align="right">4820.48</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">gamma_b</td>
<td align="left">V_B</td>
<td align="right">22.51</td>
<td align="right">10.52</td>
<td align="right">0.03</td>
<td align="right">0.05</td>
<td align="right">1.89</td>
<td align="right">43.12</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">pi_b</td>
<td align="left">Z_B</td>
<td align="right">28.10</td>
<td align="right">7.04</td>
<td align="right">0.00</td>
<td align="right">0.11</td>
<td align="right">14.30</td>
<td align="right">41.89</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">between</td>
<td align="left">alpha</td>
<td align="left">Y</td>
<td align="right">655.07</td>
<td align="right">4.78</td>
<td align="right">0.00</td>
<td align="right">0.14</td>
<td align="right">645.71</td>
<td align="right">664.42</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">mu</td>
<td align="left">Y</td>
<td align="right">2480.01</td>
<td align="right">471.79</td>
<td align="right">0.00</td>
<td align="right">0.10</td>
<td align="right">1555.30</td>
<td align="right">3404.73</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">within</td>
<td align="left">r2</td>
<td align="left">r2_w</td>
<td align="right">0.01</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
<td align="right">0.30</td>
<td align="right"></td>
<td align="right"></td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">between</td>
<td align="left">r2</td>
<td align="left">r2_b</td>
<td align="right">0.18</td>
<td align="right">0.07</td>
<td align="right">0.01</td>
<td align="right">0.14</td>
<td align="right"></td>
<td align="right"></td>
<td align="left">yes</td>
</tr>
</tbody>
</table>
<h2 id="comparison">Comparison</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing results</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># display estimates</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>texreg<span class="sc">::</span><span class="fu">screenreg</span>(<span class="fu">list</span>(fit_11, fit_4, fit_8, fit_9, fit_10), </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&#39;un&#39;</span>,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">star.symbol =</span> <span class="st">&quot;*&quot;</span>, </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">center =</span> <span class="cn">TRUE</span>, </span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">doctype =</span> <span class="cn">FALSE</span>,</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">dcolumn =</span> <span class="cn">TRUE</span>, </span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">booktabs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">single.row=</span><span class="cn">TRUE</span>,</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">custom.model.names =</span> </span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;no design&#39;</span>,</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;with design (mplus wb2)&#39;</span>,</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;STRATA as fixed effects&#39;</span>,</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;STRATA as fixed effects (wb2)&#39;</span>,</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;STRATA as fixed effects (wa2)&#39;</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<pre><code>## 
## =====================================================================================================================================================
##                  no design             with design (mplus wb2)  STRATA as fixed effects  STRATA as fixed effects (wb2)  STRATA as fixed effects (wa2)
## -----------------------------------------------------------------------------------------------------------------------------------------------------
## W Y&lt;-Z_W           12.69   (1.79) ***    12.51   (2.25) ***       12.51   (2.26) ***       12.51   (2.26) ***             12.51   (2.26) ***         
## B Y&lt;-V_B           11.96   (5.98) *      22.51  (10.39) *         20.52   (7.90) **        20.52   (7.90) **              20.52   (7.90) **          
## B Y&lt;-Z_B           42.73   (8.74) ***    28.10   (6.91) ***       25.99   (9.36) **        25.99   (9.36) **              25.99   (9.36) **          
## B Y&lt;-STRAT_2       27.09   (8.12) **                              30.39  (10.46) **        30.39  (10.46) **              30.39  (10.46) **          
## B Y&lt;-STRAT_3       36.99  (11.94) **                              53.32  (15.42) **        53.32  (15.42) **              53.32  (15.42) **          
## B Y&lt;-STRAT_4       22.30  (11.54)                                 39.95  (12.97) **        39.95  (12.97) **              39.95  (12.97) **          
## B Y&lt;-STRAT_5       38.33   (8.40) ***                             48.30   (9.77) ***       48.30   (9.77) ***             48.30   (9.77) ***         
## B Y&lt;-STRAT_6       35.57  (33.14)                                 33.90  (40.72)           33.90  (40.72)                 33.90  (40.72)             
## B Y&lt;-STRAT_7       10.38  (36.81)                                -15.98  (17.46)          -15.98  (17.46)                -15.98  (17.46)             
## B Y&lt;-Intercepts   637.36   (3.36) ***   655.07   (4.60) ***      629.46   (4.21) ***      629.46   (4.21) ***            629.46   (4.21) ***         
## W Y&lt;-&gt;Y          4579.00 (121.29) ***  4490.40 (167.57) ***     4492.12 (169.39) ***     4492.12 (169.39) ***           4492.12 (169.39) ***         
## B Y&lt;-&gt;Y          1534.32 (276.14) ***  2480.01 (471.29) ***     2155.03 (452.29) ***     2155.03 (452.29) ***           2155.03 (452.29) ***         
## =====================================================================================================================================================
## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># with and without stratification</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>texreg<span class="sc">::</span><span class="fu">screenreg</span>(<span class="fu">list</span>(fit_4, fit_12), </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&#39;un&#39;</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">star.symbol =</span> <span class="st">&quot;*&quot;</span>, </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">center =</span> <span class="cn">TRUE</span>, </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">doctype =</span> <span class="cn">FALSE</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">dcolumn =</span> <span class="cn">TRUE</span>, </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">booktabs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">single.row=</span><span class="cn">TRUE</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">custom.model.names =</span> </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;with design (mplus wb2)&#39;</span>,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;no strata info&#39;</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<pre><code>## 
## ==============================================================
##                  with design (mplus wb2)  no strata info      
## --------------------------------------------------------------
## W Y&lt;-Z_W           12.51   (2.25) ***       12.51   (2.26) ***
## B Y&lt;-V_B           22.51  (10.39) *         22.51  (10.52) *  
## B Y&lt;-Z_B           28.10   (6.91) ***       28.10   (7.04) ***
## B Y&lt;-Intercepts   655.07   (4.60) ***      655.07   (4.78) ***
## W Y&lt;-&gt;Y          4490.40 (167.57) ***     4490.40 (168.40) ***
## B Y&lt;-&gt;Y          2480.01 (471.29) ***     2480.01 (471.79) ***
## ==============================================================
## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># stratification as fixed effects</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>texreg<span class="sc">::</span><span class="fu">screenreg</span>(<span class="fu">list</span>(fit_4, fit_8), </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&#39;un&#39;</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">star.symbol =</span> <span class="st">&quot;*&quot;</span>, </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">center =</span> <span class="cn">TRUE</span>, </span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">doctype =</span> <span class="cn">FALSE</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">dcolumn =</span> <span class="cn">TRUE</span>, </span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">booktabs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">single.row=</span><span class="cn">TRUE</span>,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">custom.model.names =</span> </span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;with design (mplus wb2)&#39;</span>,</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;stratification as fixed effects&#39;</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<pre><code>## 
## =========================================================================
##                  with design (mplus wb2)  stratification as fixed effects
## -------------------------------------------------------------------------
## W Y&lt;-Z_W           12.51   (2.25) ***       12.51   (2.26) ***           
## B Y&lt;-V_B           22.51  (10.39) *         20.52   (7.90) **            
## B Y&lt;-Z_B           28.10   (6.91) ***       25.99   (9.36) **            
## B Y&lt;-Intercepts   655.07   (4.60) ***      629.46   (4.21) ***           
## W Y&lt;-&gt;Y          4490.40 (167.57) ***     4492.12 (169.39) ***           
## B Y&lt;-&gt;Y          2480.01 (471.29) ***     2155.03 (452.29) ***           
## B Y&lt;-STRAT_2                                30.39  (10.46) **            
## B Y&lt;-STRAT_3                                53.32  (15.42) **            
## B Y&lt;-STRAT_4                                39.95  (12.97) **            
## B Y&lt;-STRAT_5                                48.30   (9.77) ***           
## B Y&lt;-STRAT_6                                33.90  (40.72)               
## B Y&lt;-STRAT_7                               -15.98  (17.46)               
## =========================================================================
## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
<h1 id="annexes-2-estimates-ignoring-stratification">Annexes 2:
estimates ignoring stratification</h1>
<h2 id="code-113-mixed-model-with-stata-without-stratification">Code
1.13 mixed model with <code>STATA</code> without stratification</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mixed model with Stata</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data for Stata</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>data_stata <span class="ot">&lt;-</span> data_model <span class="sc">%&gt;%</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(ctry_name <span class="sc">==</span> <span class="st">&#39;Paraguay&#39;</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co"># configure Rstata library</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RStata)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&quot;RStata.StataPath&quot;</span><span class="ot">=</span><span class="st">&#39;/Applications/Stata/StataMP.app/Contents/MacOS/stata-mp&#39;</span>)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&quot;RStata.StataVersion&quot;</span><span class="ot">=</span><span class="dv">15</span>)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="co"># code stata</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>stata_code <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="st">* ===============================================.</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a><span class="st">* define folder and open data</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="st">* ===============================================.</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a><span class="st">* ===============================.</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a><span class="st">* fit mlm model with @pv</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a><span class="st">* ===============================.</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="st">pv, pv(MAT_1 MAT_2 MAT_3 MAT_4 MAT_5): ///</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a><span class="st">mixed @pv               ///</span></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a><span class="st">z_w                     ///</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a><span class="st">z_b                     ///</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a><span class="st">v_b                     ///</span></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a><span class="st">[pw=wb1] || id_j:, ml pweight(wb2)</span></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a><span class="st">estimates store m01</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a><span class="st">* ===============================.</span></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a><span class="st">* variance</span></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a><span class="st">* ===============================.</span></span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a><span class="st">/*return residual variance */</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a><span class="st">_diparm lnsig_e,  f(exp(@)^2) d(2*exp(@)^2)    </span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a><span class="st">/*return between  variance */</span></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a><span class="st">_diparm lns1_1_1, f(exp(@)^2) d(2*exp(@)^2)  </span></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a><span class="st">* ===============================.</span></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a><span class="st">* estimates</span></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a><span class="st">* ===============================.</span></span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a><span class="st">esttab m01, b(%9.2f) se(%9.2f) wide transform(ln*: exp(2*@) exp(2*@))</span></span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------</span></span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a><span class="co"># display stata output</span></span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------</span></span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>RStata<span class="sc">::</span><span class="fu">stata</span>(stata_code, <span class="at">data.in =</span> data_stata)</span></code></pre></div>
<pre><code>## . 
## . 
## . * ===============================================.
## . * define folder and open data
## . * ===============================================.
## . 
## . * ===============================.
## . * fit mlm model with @pv
## . * ===============================.
## . 
## . pv, pv(MAT_1 MAT_2 MAT_3 MAT_4 MAT_5): ///
## &gt; mixed @pv               ///
## &gt; z_w                     ///
## &gt; z_b                     ///
## &gt; v_b                     ///
## &gt; [pw=wb1] || id_j:, ml pweight(wb2)
## 
## command(s) run for each plausible value:
## 
##      mixed @pv               z_w                     z_b                     v_b                     [pw=wb1] || id_j:, ml pweight(wb2)
## 
## Estimates for MAT_1   complete
## Estimates for MAT_2   complete
## Estimates for MAT_3   complete
## Estimates for MAT_4   complete
## Estimates for MAT_5   complete
## 
## Number of observations: 4481
## Average R-Squared: .
## 
## 
##                      Coef    Std Err          t    t Param      P&gt;|t|
##      MAT_5:z_w  12.512955  2.2611123  5.5339821          .          .
##      MAT_5:z_b  28.119717  6.9967324  4.0189786          .          .
##      MAT_5:v_b  22.475981  10.545518  2.1313303          .          .
##    MAT_5:_cons  655.06926   4.784621  136.91142          .          .
## lns1_1_1:_cons  3.9059473   .0948134  41.196152          .          .
##  lnsig_e:_cons  4.2049035  .01879628  223.70933          .          .
## . estimates store m01
## . 
## . * ===============================.
## . * variance
## . * ===============================.
## . 
## . /*return residual variance */
## . _diparm lnsig_e,  f(exp(@)^2) d(2*exp(@)^2)    
##     /lnsig_e |   4490.893   168.8242                        4171.9    4834.278
## . /*return between  variance */
## . _diparm lns1_1_1, f(exp(@)^2) d(2*exp(@)^2)  
##    /lns1_1_1 |   2469.805   468.3413                      1703.147    3581.569
## . 
## . * ===============================.
## . * estimates
## . * ===============================.
## . 
## . esttab m01, b(%9.2f) se(%9.2f) wide transform(ln*: exp(2*@) exp(2*@))
## 
## -----------------------------------------
##                       (1)                
##                                          
## -----------------------------------------
## MAT_5                                    
## z_w                 12.51***       (2.26)
## z_b                 28.12***       (7.00)
## v_b                 22.48*        (10.55)
## _cons              655.07***       (4.78)
## -----------------------------------------
## lns1_1_1                                 
## _cons             2469.81***     (234.17)
## -----------------------------------------
## lnsig_e                                  
## _cons             4490.89***      (84.41)
## -----------------------------------------
## N                    4481                
## -----------------------------------------
## Standard errors in parentheses
## * p&lt;0.05, ** p&lt;0.01, *** p&lt;0.001
## .</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create table</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co">#----------------------------------------------------------</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>tabla_1_13 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="at">text =</span> <span class="st">&quot;</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="st">variable            e          star       se</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="st">z_w                 12.51      &#39;***&#39;      2.26</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="st">z_b                 28.12      &#39;***&#39;      7.00</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="st">v_b                 22.48      &#39;*  &#39;     10.55</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="st">_cons              655.07      &#39;***&#39;      4.78</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span>,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co"># display  table</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>tabla_1_13 <span class="sc">%&gt;%</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">variable</th>
<th align="right">e</th>
<th align="left">star</th>
<th align="right">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">z_w</td>
<td align="right">12.51</td>
<td align="left">***</td>
<td align="right">2.26</td>
</tr>
<tr class="even">
<td align="left">z_b</td>
<td align="right">28.12</td>
<td align="left">***</td>
<td align="right">7.00</td>
</tr>
<tr class="odd">
<td align="left">v_b</td>
<td align="right">22.48</td>
<td align="left">*</td>
<td align="right">10.55</td>
</tr>
<tr class="even">
<td align="left">_cons</td>
<td align="right">655.07</td>
<td align="left">***</td>
<td align="right">4.78</td>
</tr>
</tbody>
</table>
<h2 id="code-114-multilevel-model-with-wemix-ignorign-stratification">Code
1.14 multilevel model with <code>WeMix</code> ignorign
stratification</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># multilevel model with WeMix</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -------------------------------------------------------------------</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># configure R console</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">10</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare data for WeMix</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>data_wemix <span class="ot">&lt;-</span> data_model <span class="sc">%&gt;%</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>              dplyr<span class="sc">::</span><span class="fu">filter</span>(ctry_name <span class="sc">==</span> <span class="st">&#39;Paraguay&#39;</span>)</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>wemix_pv_results <span class="ot">&lt;-</span> mitools<span class="sc">::</span><span class="fu">withPV</span>(</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>   <span class="at">mapping =</span> mat <span class="sc">~</span> MAT_1 <span class="sc">+</span> MAT_2 <span class="sc">+</span> MAT_3 <span class="sc">+</span> MAT_4 <span class="sc">+</span> MAT_5, <span class="co">#&lt;&lt;</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data_wemix,</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>   <span class="at">action =</span> <span class="fu">quote</span>(</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>WeMix<span class="sc">::</span><span class="fu">mix</span>(</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>  mat <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> z_w <span class="sc">+</span> z_b <span class="sc">+</span> v_b <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id_j),</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_wemix,</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> <span class="fu">c</span>(<span class="st">&#39;wb1&#39;</span>,<span class="st">&#39;wb2&#39;</span>),</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">cWeights =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>   <span class="at">rewrite=</span><span class="cn">TRUE</span></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>   )</span></code></pre></div>
<pre><code>## Warning in WeMix::mix(MAT_1 ~ 1 + z_w + z_b + v_b + (1 | id_j), data =
## data_wemix, : There were 368 rows with missing data. These have been removed.

## Warning in WeMix::mix(MAT_2 ~ 1 + z_w + z_b + v_b + (1 | id_j), data =
## data_wemix, : There were 368 rows with missing data. These have been removed.

## Warning in WeMix::mix(MAT_3 ~ 1 + z_w + z_b + v_b + (1 | id_j), data =
## data_wemix, : There were 368 rows with missing data. These have been removed.

## Warning in WeMix::mix(MAT_4 ~ 1 + z_w + z_b + v_b + (1 | id_j), data =
## data_wemix, : There were 368 rows with missing data. These have been removed.

## Warning in WeMix::mix(MAT_5 ~ 1 + z_w + z_b + v_b + (1 | id_j), data =
## data_wemix, : There were 368 rows with missing data. These have been removed.</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># extract estimates</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">4</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>tabla_1_14 <span class="ot">&lt;-</span> <span class="fu">summary</span>(</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  miceadds<span class="sc">::</span><span class="fu">pool_mi</span>(</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">qhat =</span> <span class="fu">list</span>(</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">1</span>]]<span class="sc">$</span>coef,</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">2</span>]]<span class="sc">$</span>coef,</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">3</span>]]<span class="sc">$</span>coef,</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">4</span>]]<span class="sc">$</span>coef,</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">5</span>]]<span class="sc">$</span>coef</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">se   =</span> <span class="fu">list</span>(</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">1</span>]]<span class="sc">$</span>SE,</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">2</span>]]<span class="sc">$</span>SE,</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">3</span>]]<span class="sc">$</span>SE,</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">4</span>]]<span class="sc">$</span>SE,</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>    wemix_pv_results[[<span class="dv">5</span>]]<span class="sc">$</span>SE</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">as_tibble</span>()</span></code></pre></div>
<pre><code>## Multiple imputation results:
## Call: miceadds::pool_mi(qhat = list(wemix_pv_results[[1]]$coef, wemix_pv_results[[2]]$coef, 
##     wemix_pv_results[[3]]$coef, wemix_pv_results[[4]]$coef, wemix_pv_results[[5]]$coef), 
##     se = list(wemix_pv_results[[1]]$SE, wemix_pv_results[[2]]$SE, 
##         wemix_pv_results[[3]]$SE, wemix_pv_results[[4]]$SE, wemix_pv_results[[5]]$SE))
##             results     se       t
## (Intercept)  655.07  4.785 136.911
## z_w           12.51  2.261   5.534
## z_b           28.12  6.997   4.019
## v_b           22.48 10.546   2.131
##                                                                                                                                                                                                                                            p
## (Intercept) 0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009604
## z_w         0.000000606808194612780723595582294677130974491774395573884248733520507812500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
## z_b         0.000073243804656854551138854547698286978629766963422298431396484375000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
## v_b         0.033214235936485730915634917437273543328046798706054687500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
##              (lower upper) missInfo
## (Intercept) 645.641 664.50   14.1 %
## z_w           7.997  17.03   27.1 %
## z_b          14.353  41.89   11.9 %
## v_b           1.791  43.16    5.1 %</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># display table</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>tabla_1_14 <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(., <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">results</th>
<th align="right">se</th>
<th align="right">t</th>
<th align="right">p</th>
<th align="right">(lower</th>
<th align="right">upper)</th>
<th align="left">missInfo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">655.07</td>
<td align="right">4.78</td>
<td align="right">136.91</td>
<td align="right">0.00</td>
<td align="right">645.64</td>
<td align="right">664.50</td>
<td align="left">14.1 %</td>
</tr>
<tr class="even">
<td align="left">z_w</td>
<td align="right">12.51</td>
<td align="right">2.26</td>
<td align="right">5.53</td>
<td align="right">0.00</td>
<td align="right">8.00</td>
<td align="right">17.03</td>
<td align="left">27.1 %</td>
</tr>
<tr class="odd">
<td align="left">z_b</td>
<td align="right">28.12</td>
<td align="right">7.00</td>
<td align="right">4.02</td>
<td align="right">0.00</td>
<td align="right">14.35</td>
<td align="right">41.89</td>
<td align="left">11.9 %</td>
</tr>
<tr class="even">
<td align="left">v_b</td>
<td align="right">22.48</td>
<td align="right">10.55</td>
<td align="right">2.13</td>
<td align="right">0.03</td>
<td align="right">1.79</td>
<td align="right">43.16</td>
<td align="left">5.1 %</td>
</tr>
</tbody>
</table>

</body>
</html>
